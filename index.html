<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; font-src 'self' https://cdnjs.cloudflare.com https://fonts.gstatic.com; img-src 'self' data: https://via.placeholder.com; object-src 'none'; frame-src 'none';"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- Primary Meta Tags -->
    <title>Mike Sites - Professional Web Developer & Designer</title>
    <meta name="description" content="Mike Sites - Professional Web Developer & Designer in Nairobi, Kenya. Specializing in modern web applications, e-commerce solutions, and custom development."/>
    <meta name="keywords" content="web developer, web designer, Nairobi, Kenya, modern web applications, e-commerce, custom development"/>
    <meta name="author" content="Mike Sites"/>
    <meta name="robots" content="index, follow"/>
    <meta name="theme-color" content="#00d9ff"/>
    <link rel="canonical" href="https://garymike07.github.io/Mike-site/"/>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico"/>
    <link rel="icon" type="image/webp" href="myk_logo.webp"/>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://garymike07.github.io/Mike-site/"/>
    <meta property="og:title" content="Mike Sites - Professional Web Developer & Designer"/>
    <meta property="og:description" content="Crafting exceptional digital experiences in Nairobi, Kenya"/>
    <meta property="og:image" content="https://garymike07.github.io/Mike-sites/myk_logo.webp"/>
    <meta property="og:site_name" content="Mike Sites"/>
    <meta property="og:locale" content="en_US"/>

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:url" content="https://garymike07.github.io/Mike-site/"/>
    <meta name="twitter:title" content="Mike Sites - Professional Web Developer & Designer"/>
    <meta name="twitter:description" content="Crafting exceptional digital experiences in Nairobi, Kenya"/>
    <meta name="twitter:image" content="https://garymike07.github.io/Mike-sites/myk_logo.webp"/>

    <!-- Preload assets -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"/>

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com"/>
    <link rel="dns-prefetch" href="//fonts.googleapis.com"/>

<style>
html {
  font-size: 18px; /* Base font size */
  scroll-behavior: smooth;
}

@media (max-width: 768px) {
  html {
    font-size: 15px;
  }
}

@media (max-width: 480px) {
  html {
    font-size: 14px;
  }
}

:root {
  --bg-primary: #0B0F19;
  --bg-secondary: #1A1E2D;
  --bg-tertiary: #2A2E3C;
  --text-primary: #EAEAEA;
  --text-secondary: #B0B0B0;
  --accent-primary: #6C63FF;
  --accent-secondary: #FF6584;
  --accent-tertiary: #36D1DC;
  --accent-quaternary: #FFD700;
  --accent-custom: #FF1493;
  --gradient-primary: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  --gradient-secondary: linear-gradient(135deg, var(--accent-secondary), var(--accent-primary));
  --gradient-custom: linear-gradient(135deg, var(--accent-primary), #ff69b4);
  --gradient-glass: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
  --border-color: rgba(255, 255, 255, 0.2);
  --shadow-color: rgba(0, 0, 0, 0.2);
  --shadow-glow: 0 0 40px rgba(108, 99, 255, 0.6);
  --shadow-custom: 0 0 40px rgba(108, 99, 255, 0.6);
  --success-color: #36D1DC;
  --warning-color: #FFD700;
  --error-color: #FF6584;
  --live-color: #36D1DC;
  --ongoing-color: #FFD700;
  --concept-color: #B0B0B0;
  --construction-color: #FF6584;
}

[data-theme="light"] {
  --bg-primary: #ffffff;
  --bg-secondary: #f8f9fa;
  --bg-tertiary: #e9ecef;
  --text-primary: #212529;
  --text-secondary: #6c757d;
  --border-color: #dee2e6;
  --shadow-color: rgba(0, 0, 0, 0.1);
}

[data-theme="synthwave"] {
  --bg-primary: #0d0221;
  --bg-secondary: #261447;
  --bg-tertiary: #3a1f7a;
  --text-primary: #f0f8ff;
  --text-secondary: #c9c9ff;
  --accent-primary: #ff00ff;
  --accent-secondary: #00ffff;
  --border-color: rgba(255, 0, 255, 0.3);
  --shadow-color: rgba(42, 1, 99, 0.5);
  --gradient-primary: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Courier New', Courier, monospace;
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.6;
  overflow-x: hidden;
  padding-top: 80px;
  position: relative;
  animation: typing 1s steps(20, end);
  font-weight: bold;
}

@keyframes typing {
  from { width: 0 }
  to { width: 100% }
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: 
    radial-gradient(circle at 20% 80%, rgba(157, 78, 221, 0.3) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(0, 217, 255, 0.3) 0%, transparent 50%),
    radial-gradient(circle at 40% 40%, rgba(247, 37, 133, 0.2) 0%, transparent 50%),
    radial-gradient(circle at 60% 70%, rgba(255, 107, 53, 0.2) 0%, transparent 50%);
  z-index: -1;
  animation: backgroundShift 25s ease-in-out infinite;
}

@keyframes backgroundShift {
  0%, 100% { 
    transform: translateX(0) translateY(0) rotate(0deg); 
    filter: hue-rotate(0deg);
  }
  25% { 
    transform: translateX(-30px) translateY(-15px) rotate(2deg); 
    filter: hue-rotate(90deg);
  }
  50% { 
    transform: translateX(30px) translateY(15px) rotate(-2deg); 
    filter: hue-rotate(180deg);
  }
  75% { 
    transform: translateX(-15px) translateY(30px) rotate(1deg); 
    filter: hue-rotate(270deg);
  }
}

/* Header */
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: rgba(26, 26, 46, 0.7);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border-bottom: 2px solid var(--border-color);
  padding: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 1000;
  height: 80px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
}

.logo {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 1.2rem;
  font-weight: 700;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  white-space: nowrap;
}

.logo img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
}

.theme-toggle {
  background: var(--gradient-glass);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--border-color);
  border-radius: 50px;
  padding: 0.75rem;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}

.theme-toggle::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--gradient-primary);
  opacity: 0;
  transition: opacity 0.4s ease;
}

.theme-toggle:hover::before {
  opacity: 0.2;
}

.theme-toggle:hover {
  transform: scale(1.1);
  box-shadow: var(--shadow-glow);
  border-color: var(--accent-primary);
}

/* Hero Section */
.hero {
  min-height: calc(100vh - 80px);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  padding: 2rem 1rem;
  position: relative;
  background: radial-gradient(ellipse at center, rgba(0, 217, 255, 0.1) 0%, transparent 70%);
}

.hero-nav {
  position: static;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  gap: 0.5rem;
  justify-content: center;
  margin-bottom: 2rem;
  z-index: 100;
  width: 100%;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1rem;
  background: var(--gradient-glass);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 2px solid var(--border-color);
  border-radius: 50px;
  color: var(--text-secondary);
  text-decoration: none;
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  font-size: 0.8rem;
  font-weight: 500;
  min-height: 44px;
  white-space: nowrap;
  position: relative;
  overflow: hidden;
  box-shadow: 
    0 4px 16px rgba(0, 0, 0, 0.5),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.nav-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: var(--gradient-primary);
  transition: left 0.5s ease;
  z-index: -1;
  border-radius: 48px;
}

.nav-item:hover::before, .nav-item.active::before {
  left: 0;
}

.nav-item:hover, .nav-item.active {
  color: var(--bg-primary);
  transform: translateY(-3px) scale(1.05);
  box-shadow: 
    var(--shadow-glow),
    0 8px 24px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  border-color: var(--accent-primary);
}

.hero-content {
  max-width: 800px;
  margin: 2rem 0;
  width: 100%;
}

.hero-title {
  font-size: 2.5rem;
  font-weight: 800;
  margin-bottom: 1rem;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  line-height: 1.2;
}

.hero-subtitle {
  font-size: 1.1rem;
  color: var(--text-secondary);
  margin-bottom: 2rem;
  line-height: 1.6;
}

/* Hero Contact Information */
.hero-contact {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  margin-bottom: 2rem;
  padding: 1.5rem;
  background: var(--gradient-glass);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--border-color);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  animation: contactGlow 3s ease-in-out infinite alternate;
}

.hero-contact p {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  color: var(--text-primary);
  font-weight: 500;
  font-size: 1rem;
}

.hero-contact i {
  color: var(--accent-primary);
  font-size: 1.1rem;
  width: 20px;
  text-align: center;
}

@keyframes contactGlow {
  0% { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); }
  100% { box-shadow: 0 8px 32px rgba(0, 245, 255, 0.2), 0 0 20px rgba(255, 107, 53, 0.1); }
}

.hero-cta {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  align-items: center;
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  padding: 1rem 2rem;
  border-radius: 50px;
  text-decoration: none;
  font-weight: 600;
  transition: all 0.3s ease;
  border: none;
  cursor: pointer;
  font-size: 1rem;
  min-height: 44px;
  width: 100%;
  max-width: 300px;
}

.btn-primary {
  background: var(--gradient-primary);
  color: var(--bg-primary);
  position: relative;
  overflow: hidden;
}

.btn-primary::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.6s ease;
}

.btn-primary:hover::before {
  left: 100%;
}

.btn-primary:hover {
  transform: translateY(-3px) scale(1.05);
  box-shadow: 0 15px 40px var(--shadow-color);
}

/* Custom Request Button - Extra Prominent */
.btn-custom-request {
  background: var(--gradient-custom) !important;
  font-size: 1.1rem !important;
  padding: 1.25rem 2.5rem !important;
  font-weight: 700 !important;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  animation: customButtonPulse 2s ease-in-out infinite;
  box-shadow: var(--shadow-custom);
  border: 2px solid var(--accent-custom);
}

.btn-custom-request:hover {
  transform: translateY(-5px) scale(1.08) !important;
  box-shadow: var(--shadow-custom), 0 20px 50px rgba(255, 107, 53, 0.3) !important;
  animation: none;
}

@keyframes customButtonPulse {
  0%, 100% { 
    box-shadow: var(--shadow-custom);
    transform: scale(1);
  }
  50% { 
    box-shadow: var(--shadow-custom), 0 0 30px rgba(255, 107, 53, 0.5);
    transform: scale(1.02);
  }
}

.btn-secondary {
  background: transparent;
  color: var(--text-primary);
  border: 2px solid var(--border-color);
}

.btn-secondary:hover {
  background: var(--bg-secondary);
  border-color: var(--accent-primary);
}

/* Stats */
.stats {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
  margin-top: 3rem;
  max-width: 1000px;
  width: 100%;
}

.stat-card {
  background: var(--gradient-glass);
  backdrop-filter: blur(30px);
  -webkit-backdrop-filter: blur(30px);
  padding: 2rem;
  border-radius: 24px;
  text-align: center;
  border: 3px solid var(--border-color);
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.6),
    0 0 0 1px rgba(255, 255, 255, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  transform: translateZ(0);
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--gradient-primary);
  opacity: 0;
  transition: opacity 0.5s ease;
  border-radius: 22px;
}

.stat-card:hover::before {
  opacity: 0.12;
}

.stat-card:hover {
  transform: translateY(-12px) scale(1.05) rotateY(5deg);
  box-shadow: 
    var(--shadow-glow), 
    0 24px 80px rgba(0, 0, 0, 0.5),
    0 0 0 2px var(--accent-primary),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border-color: var(--accent-primary);
}

.stat-card * {
  position: relative;
  z-index: 2;
}

.stat-number {
  font-size: 2rem;
  font-weight: 700;
  color: var(--accent-primary);
}

.stat-label {
  color: var(--text-secondary);
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stat-trend {
  font-size: 0.8rem;
  color: var(--success-color);
  margin-top: 0.5rem;
}

/* Projects Section */
.projects-section {
  padding: 4rem 1rem;
  background: var(--bg-primary);
}

.section-header {
  text-align: center;
  margin-bottom: 3rem;
}

.section-title {
  font-size: 2rem;
  font-weight: 700;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.section-subtitle {
  color: var(--text-secondary);
  font-size: 1rem;
  max-width: 600px;
  margin: 1rem auto 0;
}

/* Filters */
.filters-container {
  max-width: 1200px;
  margin: 0 auto 3rem;
}

.search-container {
  margin-bottom: 2rem;
}

.search-input-wrapper {
  position: relative;
  max-width: 500px;
  margin: 0 auto;
}

.search-input {
  width: 100%;
  padding: 1rem 3rem 1rem 3rem;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 50px;
  color: var(--text-primary);
  font-size: 1rem;
  outline: none;
  transition: all 0.3s ease;
}

.search-input:focus {
  border-color: var(--accent-primary);
  box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.1);
}

.search-icon {
  position: absolute;
  left: 1rem;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-secondary);
}

.search-clear {
  position: absolute;
  right: 1rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  opacity: 0;
  transition: all 0.3s ease;
  min-width: 44px;
  min-height: 44px;
}

.search-clear.visible {
  opacity: 1;
}

.project-filters {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-bottom: 2rem;
}

.filter-btn {
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  color: var(--text-secondary);
  padding: 0.75rem 1.5rem;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.9rem;
  font-weight: 500;
  min-height: 44px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.filter-btn:hover, .filter-btn.active {
  background: var(--accent-primary);
  color: var(--bg-primary);
  border-color: var(--accent-primary);
}

.filter-count {
  background: var(--bg-tertiary);
  color: var(--text-primary);
  padding: 0.25rem 0.5rem;
  border-radius: 12px;
  font-size: 0.75rem;
  margin-left: 0.5rem;
}

.filter-btn.active .filter-count {
  background: rgba(255, 255, 255, 0.2);
  color: var(--bg-primary);
}

/* Projects Container */
.projects-container {
  position: relative;
  overflow: hidden;
  margin-bottom: 2rem;
}

.projects-scroll {
  display: flex;
  flex-direction: column;
  gap: 2rem;
  padding: 1rem 0 2rem;
}

.project-card {
  background: var(--gradient-glass);
  backdrop-filter: blur(30px);
  -webkit-backdrop-filter: blur(30px);
  border-radius: 24px;
  overflow: hidden;
  border: 3px solid var(--border-color);
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: pointer;
  width: 100%;
  position: relative;
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.6),
    0 0 0 1px rgba(255, 255, 255, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  transform: translateZ(0);
}

.project-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--gradient-primary);
  opacity: 0;
  transition: opacity 0.5s ease;
  z-index: 1;
  border-radius: 22px;
}

.project-card:hover::before {
  opacity: 0.15;
}

.project-card:hover {
  transform: translateY(-16px) scale(1.03) rotateX(5deg);
  box-shadow: 
    var(--shadow-glow), 
    0 32px 100px rgba(0, 0, 0, 0.5),
    0 0 0 2px var(--accent-primary),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  border-color: var(--accent-primary);
}

.project-card * {
  position: relative;
  z-index: 2;
}

.project-image {
  height: 200px;
  background: var(--gradient-primary);
  position: relative;
  overflow: hidden;
}

.project-thumbnail {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.project-status {
  position: absolute;
  top: 1rem;
  right: 1rem;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.status-live {
  background: var(--live-color);
  color: #fff;
}

.status-ongoing {
  background: var(--ongoing-color);
  color: #000;
}

.status-concept {
  background: var(--concept-color);
  color: #fff;
}

.status-construction {
  background: var(--construction-color);
  color: #fff;
}

.project-content {
  padding: 1.5rem;
}

.project-title {
  font-size: 1.35rem;
  font-weight: 600;
  margin-bottom: 0.75rem;
}

.project-date {
  font-size: 0.85rem; /* Slightly larger */
  color: var(--text-secondary);
  margin-bottom: 1rem;
}

.project-description {
  color: var(--text-secondary);
  font-size: 1rem; /* Increased for readability */
  line-height: 1.65;
  margin-bottom: 1.5rem;
}

.project-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.tag {
  background: var(--bg-tertiary);
  color: var(--text-secondary);
  padding: 0.25rem 0.75rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 500;
}

.project-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 1rem;
  border-top: 1px solid var(--border-color);
}

.project-actions {
    display: flex;
    gap: 0.25rem; /* Reduced gap */
    flex-wrap: wrap; /* Allow buttons to wrap */
    justify-content: flex-end;
}

.project-price {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--accent-primary);
  flex-shrink: 0; /* Prevent price from shrinking */
  margin-right: 0.5rem;
}

.add-to-cart {
  background: var(--gradient-primary);
  color: var(--bg-primary);
  border: none;
  padding: 0.6rem 0.8rem; /* Reduced padding */
  border-radius: 18px; /* Slightly smaller radius */
  font-size: 0.7rem; /* Reduced font size */
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  min-height: 38px; /* Reduced min-height */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.3rem;
  flex-shrink: 0; /* Prevent buttons from shrinking */
}

.add-to-cart:hover {
  transform: translateY(-1px);
}

.add-to-cart:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* Progress Bar for Ongoing Projects */
.progress-container {
  margin: 1rem 0;
}

.progress-label {
  display: flex;
  justify-content: space-between;
  margin-bottom: 0.5rem;
  font-size: 0.8rem;
  color: var(--text-secondary);
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--bg-tertiary);
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--gradient-primary);
  transition: width 0.3s ease;
}

/* Shopping Cart */
.cart-container {
  position: fixed;
  bottom: 2rem;
  right: 1rem;
  z-index: 1000;
}

.cart-button {
  background: var(--gradient-primary);
  color: var(--bg-primary);
  border: none;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cart-button:hover {
  transform: scale(1.1);
}

.cart-count {
  position: absolute;
  top: -5px;
  right: -5px;
  background: var(--accent-secondary);
  color: white;
  border-radius: 50%;
  width: 25px;
  height: 25px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  font-weight: 600;
}

.cart-sidebar {
  position: fixed;
  top: 0;
  right: -100%;
  width: 100%;
  height: 100vh;
  background: var(--bg-primary);
  border-left: 1px solid var(--border-color);
  transition: right 0.3s ease;
  z-index: 1001;
  overflow-y: auto;
}

.cart-sidebar.open {
  right: 0;
}

.cart-header {
  padding: 2rem 1rem 1rem;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.cart-title {
  font-size: 1.5rem;
  font-weight: 600;
}

.cart-close {
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: 1.5rem;
  cursor: pointer;
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cart-items {
  padding: 1rem;
}

.cart-item {
  display: flex;
  gap: 1rem;
  padding: 1rem 0;
  border-bottom: 1px solid var(--border-color);
}

.cart-item-image {
  width: 60px;
  height: 60px;
  background: var(--gradient-primary);
  border-radius: 8px;
  flex-shrink: 0;
  object-fit: cover;
}

.cart-item-details {
  flex: 1;
  min-width: 0;
}

.cart-item-title {
  font-weight: 600;
  margin-bottom: 0.5rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.cart-item-price {
  color: var(--accent-primary);
  font-weight: 600;
}

.cart-item-remove {
  background: var(--error-color);
  color: white;
  border: none;
  padding: 0.5rem;
  border-radius: 4px;
  cursor: pointer;
  min-width: 44px;
  min-height: 44px;
}

.cart-footer {
  padding: 1rem;
  border-top: 1px solid var(--border-color);
  background: var(--bg-secondary);
}

.cart-total {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  font-size: 1.2rem;
  font-weight: 600;
}

.cart-checkout {
  background: var(--gradient-primary);
  color: var(--bg-primary);
  border: none;
  padding: 1rem;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  width: 100%;
  transition: all 0.3s ease;
  min-height: 44px;
}

.cart-checkout:hover {
  transform: translateY(-1px);
}

.cart-empty {
  text-align: center;
  padding: 3rem 1rem;
  color: var(--text-secondary);
}

.cart-empty i {
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
}

/* Project Modal - Enhanced Layout */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(10, 25, 47, 0.85); /* Darker backdrop */
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.4s ease, visibility 0.4s ease; /* Smoother transition */
  padding: 1rem;
}

.modal.active {
  opacity: 1;
  visibility: visible;
}

.modal.active .modal-content {
    transform: scale(1);
}

.modal-content {
  background: rgba(26, 30, 45, 0.6); /* Using a slightly transparent version of --bg-secondary */
  backdrop-filter: blur(40px);
  -webkit-backdrop-filter: blur(40px);
  border-radius: 24px;
  width: 90%;
  max-width: 1250px;
  max-height: 95vh;
  overflow: hidden;
  position: relative;
  border: 1px solid;
  border-image-slice: 1;
  border-image-source: linear-gradient(to bottom right, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.1));
  display: flex;
  flex-direction: column;
  box-shadow: 0 20px 60px var(--shadow-color);
  transform: scale(0.95);
  transition: transform 0.4s ease;
}

.modal-header {
  padding: 1rem 2rem;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--bg-secondary);
  flex-shrink: 0;
}

.modal-title {
  font-size: 1.5rem; /* Larger title */
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: calc(100% - 60px);
}

.modal-close {
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: 1.5rem;
  cursor: pointer;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.3s ease;
}

.modal-close:hover {
  background: var(--bg-tertiary);
  transform: rotate(90deg);
}

.modal-body {
  display: grid;
  grid-template-columns: 1fr; /* Default for mobile */
  gap: 2rem;
  padding: 2rem;
  height: 100%;
  overflow: hidden; /* Hide overflow on the container */
}

@media (min-width: 992px) {
  .modal-body {
    grid-template-columns: 2fr 1fr; /* Two columns for wider screens */
  }
}

@media (max-width: 992px) {
  .modal-body {
    overflow-y: auto; /* Make body scrollable on smaller screens */
  }
}
.modal-gallery {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  overflow: hidden;
  min-height: 400px;
}

.modal-main-image {
  width: 100%;
  flex-grow: 1;
  height: 1px; /* Flexbox height hack */
  object-fit: cover;
  border-radius: 16px;
  border: 1px solid var(--border-color);
  background-color: var(--bg-secondary);
}

.modal-thumbnails {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 0.75rem;
  max-height: 100px;
  overflow-y: auto;
  padding: 5px;
}

.modal-thumbnail {
  width: 100%;
  height: 60px;
  object-fit: cover;
  border-radius: 8px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.3s ease;
  opacity: 0.7;
}

.modal-thumbnail:hover {
  opacity: 1;
  transform: scale(1.05);
  border-color: var(--accent-secondary);
}

.modal-thumbnail.active {
  opacity: 1;
  border-color: var(--accent-primary);
  box-shadow: 0 0 15px var(--shadow-color);
}

.modal-details {
  overflow-y: auto;
  padding-right: 15px; /* For scrollbar */
}

.modal-description {
  font-size: 1rem;
  color: var(--text-primary); /* Brighter color for readability */
  line-height: 1.7;
  margin-bottom: 1.5rem;
}

.modal-section-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 2rem 0 1rem 0;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border-color);
}

.modal-price-tag {
    background: var(--gradient-glass);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.price-label {
    font-weight: 500;
    color: var(--text-primary);
}

.price-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent-primary);
}

.modal-features-list {
    list-style: none;
    padding: 0;
    margin: 0;
    color: var(--text-primary);
}

.modal-features-list li {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
}

.modal-features-list i {
    color: var(--accent-primary);
}

.progress-date {
    font-size: 0.8rem;
    color: var(--text-secondary);
    text-align: right;
    margin-top: 0.5rem;
}

.modal-footer {
  padding: 1rem 2rem;
  border-top: 1px solid var(--border-color);
  background: var(--bg-secondary);
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
}

.modal-links {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.modal-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.4rem;
  padding: 0.6rem 1rem;
  background: var(--bg-tertiary);
  color: var(--text-primary);
  text-decoration: none;
  border-radius: 6px;
  transition: all 0.3s ease;
  font-size: 0.85rem;
  font-weight: 500;
  min-height: 40px;
}

.modal-link:hover {
  background: var(--accent-primary);
  color: var(--bg-primary);
}

.modal-link.disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.modal-link.disabled:hover {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

/* Social Share Buttons */
.social-share {
  text-align: center;
}

.social-share h4 {
  font-size: 0.9rem;
  margin-bottom: 0.75rem;
  color: var(--text-secondary);
  display: none; /* Title hidden for a cleaner look, but kept for semantics */
}

.social-share .share-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  text-decoration: none;
  color: #fff !important; /* Important to override other link styles */
  padding: 0.5rem 1rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 500;
  transition: all 0.3s ease;
  margin: 0 0.25rem;
  border: none;
}

.social-share .share-btn:hover {
  transform: translateY(-2px);
  opacity: 0.9;
}

.share-btn.twitter {
  background-color: #1DA1F2;
}

.share-btn.linkedin {
  background-color: #0A66C2;
}

.share-btn.facebook {
  background-color: #1877F2;
}

/* About Me Modal Styles */
#about-modal .modal-content {
  max-width: 500px;
  max-height: 90vh;
}

.about-modal-content {
  text-align: center;
}

.about-modal-image {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  margin-bottom: 1.5rem;
  border: 4px solid var(--accent-primary);
  box-shadow: 0 0 20px var(--shadow-color);
}

.about-modal-text {
  margin-bottom: 1.5rem;
  color: var(--text-secondary);
  font-size: 1rem;
  line-height: 1.6;
}

.about-modal-name {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 0.5rem;
}

.about-modal-bio {
  color: var(--text-secondary);
  font-size: 1rem;
  line-height: 1.6;
  max-width: 400px;
  margin: 0 auto 1.5rem;
}

.about-modal-footer {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid var(--border-color);
  font-weight: 500;
  color: var(--text-primary);
}

/* Contact Modal Styles */
#contact-modal .modal-content {
  max-width: 800px;
  max-height: 90vh;
}

/* Request Modal Form Styles */
.request-form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-group label {
    font-weight: 500;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 1rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: 1rem;
    outline: none;
    transition: all 0.3s ease;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.1);
}

#contact-modal .contact-container {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
}

#contact-modal .contact-info {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
}

#contact-modal .contact-card {
  background: var(--gradient-glass);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  padding: 2rem;
  border-radius: 24px;
  text-align: center;
  border: 2px solid var(--border-color);
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

#contact-modal .contact-card:hover {
  transform: translateY(-10px);
  box-shadow: var(--shadow-glow);
}

#contact-modal .contact-icon {
  width: 50px;
  height: 50px;
  background: var(--gradient-primary);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1rem;
  font-size: 1.2rem;
  color: var(--bg-primary);
}

/* Responsive breakpoints */
@media (min-width: 480px) {
  .hero-cta {
    flex-direction: row;
    justify-content: center;
  }
  
  .btn {
    width: auto;
  }
  
  .stats {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .project-filters {
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .filter-btn {
    width: auto;
  }
  
  .modal-footer {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
  
  .modal-links {
    flex-direction: row;
  }
  
  .cart-sidebar {
    width: 400px;
  }
}

@media (max-width: 480px) {
  .hero-title {
    font-size: 2.2rem;
  }
  .hero-subtitle {
    font-size: 1rem;
  }
}

@media (min-width: 768px) {
  .hero-title {
    font-size: 3rem;
  }
  
  .hero-subtitle {
    font-size: 1.25rem;
  }
  
  .section-title {
    font-size: 2.5rem;
  }
  
  .stats {
    grid-template-columns: repeat(4, 1fr);
  }
  
  .projects-scroll {
    flex-direction: row;
    overflow-x: auto;
    scrollbar-width: none;
  }
  
  .projects-scroll::-webkit-scrollbar {
    display: none;
  }
  
  .project-card {
    min-width: 350px;
    flex-shrink: 0;
  }
}

@media (min-width: 1024px) {
  .hero {
    padding: 2rem;
  }
  
  .hero-title {
    font-size: 3.5rem;
  }
  
  .projects-section {
    padding: 6rem 2rem;
  }
}

/* Scroll Animations */
.fade-in-element {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.fade-in-element.is-visible {
  opacity: 1;
  transform: translateY(0);
}

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

.nav-item:focus,
.btn:focus,
.filter-btn:focus,
.add-to-cart:focus,
.cart-button:focus,
.theme-toggle:focus {
  outline: 2px solid var(--accent-primary);
  outline-offset: 2px;
}

@media (prefers-contrast: high) {
  :root {
    --border-color: #ffffff;
    --bg-secondary: #000000;
    --text-secondary: #ffffff;
  }
}

/* Clock Widget */
.clock-widget {
  position: fixed;
  top: 100px;
  left: 1rem;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 16px;
  padding: 1rem;
  z-index: 999;
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 30px var(--shadow-color);
  min-width: 200px;
  text-align: center;
}

.clock-time {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--accent-primary);
  margin-bottom: 0.5rem;
  font-family: 'Courier New', monospace;
}

.clock-date {
  font-size: 0.9rem;
  color: var(--text-secondary);
  margin-bottom: 0.5rem;
}

.clock-seconds {
  font-size: 0.8rem;
  color: var(--text-secondary);
  opacity: 0.7;
}

@media (max-width: 768px) {
  .clock-widget {
    position: relative;
    top: 0;
    left: 0;
    margin: 1rem auto;
    width: fit-content;
  }
}

@media print {
  .header,
  .cart-container {
    display: none;
  }
  
  body {
    padding-top: 0;
  }
  
  .hero {
    min-height: auto;
    page-break-after: always;
  }
}

/* Skip link for accessibility */
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--accent-primary);
  color: var(--bg-primary);
  padding: 1rem;
  z-index: 10001; /* Higher than header */
  transition: top 0.3s ease;
  border-radius: 0 0 8px 0;
  font-weight: 600;
  text-decoration: none;
}

.skip-link:focus {
  top: 0;
}

/* Utility classes */
.hidden {
  display: none !important;
}
.text-center {
    text-align: center;
}
.mb-2 {
    margin-bottom: 2rem;
}

/* Modal-specific styles */
.modal-content--small {
    max-width: 500px;
    height: auto;
}
.modal-content--large {
    max-width: 800px;
    height: auto;
}
.modal-body--single-col {
    grid-template-columns: 1fr;
    overflow-y: auto;
}

/* Form-specific styles */
.form-input--spaced {
    margin-top: 1rem;
    margin-bottom: 1rem;
}
.btn--full-width {
    width: 100%;
}

/* Footer styles */
.footer {
  text-align: center;
  padding: 2rem 1rem;
  background: var(--bg-secondary);
  color: var(--text-secondary);
  border-top: 1px solid var(--border-color);
}

/* Tools Modal Styles */
#tools-modal-body {
    background-color: var(--bg-primary);
    padding: 1.5rem;
    max-height: calc(90vh - 120px); /* Adjust based on header/footer height */
    overflow-y: auto;
}

.tool-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 1.5rem;
}

.tool-group-title {
    font-size: 1.2rem;
    color: var(--accent-secondary);
    margin: 2rem 0 1rem 0;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border-color);
}

.tool-card {
    background: var(--gradient-glass);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.tool-card h3 {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-primary);
}

.tool-card .form-group {
    gap: 0.25rem;
}

.tool-card textarea.search-input {
    min-height: 100px;
    font-family: 'Courier New', Courier, monospace;
    font-size: 0.9rem;
}

.tool-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.tool-actions .btn {
    flex-grow: 1;
    font-size: 0.85rem;
    padding: 0.5rem 1rem;
}

.tool-status {
    font-size: 0.9rem;
    font-weight: 500;
    min-height: 20px;
    text-align: center;
}
.tool-status.success {
    color: var(--success-color);
}
.tool-status.error {
    color: var(--error-color);
}

.counter-results {
    display: flex;
    justify-content: space-around;
    padding: 0.75rem;
    background: var(--bg-tertiary);
    border-radius: 8px;
    font-weight: 500;
}

.color-converter-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
}

.color-preview-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
}

.color-preview {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 2px solid var(--border-color);
    background-color: #ffffff;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

/* Learning Modal Styles */
#learning-modal-body {
    background-color: var(--bg-primary);
    padding: 1.5rem;
    max-height: calc(90vh - 120px);
    overflow-y: auto;
}

.learning-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2.5rem;
}

.learning-category-title {
    font-size: 1.3rem;
    color: var(--accent-primary);
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 1rem;
}

.learning-item {
    background: var(--gradient-glass);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    transition: all 0.3s ease;
}

.learning-item:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-glow);
}

.learning-item-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.learning-item-header i {
    font-size: 1.5rem;
    color: var(--accent-secondary);
}

.learning-item-header h4 {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
}

.learning-item p {
    color: var(--text-secondary);
    font-size: 0.95rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
}

.learning-progress {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.learning-progress .progress-bar {
    flex-grow: 1;
}

.learning-progress span {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-secondary);
    white-space: nowrap;
}

/* GitHub Modal Styles */
#github-modal-body {
    background-color: var(--bg-primary);
    padding: 1.5rem;
    max-height: calc(90vh - 120px); /* Adjust based on header/footer height */
    overflow-y: auto;
}

#github-repo-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.repo-card {
    background: var(--gradient-glass);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.repo-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-color);
}

.repo-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-primary);
}

.repo-date {
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.repo-description {
    color: var(--text-secondary);
    line-height: 1.6;
}

.repo-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
}

.repo-actions {
    display: flex;
    gap: 1rem;
}

.repo-actions .btn {
    padding: 0.6rem 1.2rem;
    font-size: 0.9rem;
}

.repo-changelog {
    font-size: 0.9rem;
    color: var(--text-secondary);
    width: 100%; /* Make it full width */
    margin-top: 1rem;
    font-style: normal; /* Override italic */
}

.changelog-content {
    margin-top: 1rem;
    padding: 1rem;
    background: var(--bg-tertiary);
    border-radius: 8px;
    max-height: 300px;
    overflow-y: auto;
}

.commit-entry {
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-color);
}

.commit-entry:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
}

.commit-message {
    font-weight: 500;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    white-space: pre-wrap; /* To respect newlines in commit messages */
}

.commit-meta {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

/* Comments Modal Styles */
#comments-modal-body {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.comment-list-container {
    flex-grow: 1;
    overflow-y: auto;
    min-height: 200px; /* Ensure it has some height even when empty */
    padding-right: 1rem; /* for scrollbar */
}

#comment-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.comment-card {
    background: var(--gradient-glass);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    display: flex;
    gap: 1.5rem;
    align-items: flex-start;
}

.comment-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: var(--gradient-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 1.2rem;
    color: var(--bg-primary);
    flex-shrink: 0;
}

.comment-content {
    flex-grow: 1;
}

.comment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.comment-author {
    font-weight: 600;
    color: var(--text-primary);
}

.comment-date {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

.comment-text {
    color: var(--text-secondary);
    line-height: 1.6;
    white-space: pre-wrap;
    word-break: break-word;
}

#comment-list:empty::before {
    content: 'No comments yet. Be the first to share your thoughts!';
    text-align: center;
    padding: 2rem;
    color: var(--text-secondary);
    display: block;
}

/* Scraper Results Styles */
.scraped-item {
    background: var(--bg-tertiary);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    border-left: 3px solid var(--accent-primary);
}
.scraped-item h4 {
    margin: 0 0 0.5rem 0;
    color: var(--accent-primary);
}
.scraped-item p {
    margin: 0 0 0.5rem 0;
    color: var(--text-secondary);
}
.scraped-item span {
    font-weight: 600;
    color: var(--text-primary);
}

.course-outline {
    margin-top: 1rem;
    padding: 1rem;
    background: var(--bg-tertiary);
    border-radius: 8px;
}

.course-outline h5 {
    color: var(--accent-secondary);
    margin-top: 1rem;
    margin-bottom: 0.5rem;
}

.course-outline ul {
    list-style-type: disc;
    padding-left: 20px;
}
</style>
</head>

<body>
  <a href="#main" class="skip-link">Skip to main content</a>
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <img src="myk_logo.webp" alt="Mike Lab Logo"/>
      Mike Lab
    </div>
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
      <i class="fas fa-moon"></i>
    </button>
  </header>

  <main id="main">

  <!-- Clock Widget -->
  <div class="clock-widget" id="clock-widget">
    <div class="clock-time" id="clock-time">00:00:00</div>
    <div class="clock-date" id="clock-date">Loading...</div>
    <div class="clock-seconds" id="clock-seconds">00</div>
  </div>

  <!-- Hero Section -->
  <section class="hero" id="home">
    <!-- Mobile-responsive navigation -->
    <nav class="hero-nav">
      <a href="#home" class="nav-item active">
        <i class="fas fa-home"></i>
        <span>Home</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="blogModal">
        <i class="fas fa-blog"></i> <span>Blog</span>
      </a>
      <a href="#projects" class="nav-item">
        <i class="fas fa-briefcase"></i>
        <span>Projects</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="toolsModal">
        <i class="fas fa-tools"></i> <span>Tools</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="changelogModal">
        <i class="fas fa-history"></i> <span>Changelog</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="techSpecsModal">
        <i class="fas fa-file-code"></i> <span>Specs</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="currentlyLearningModal">
        <i class="fas fa-book-open"></i> <span>Learning</span>
      </a>
      <a href="javascript:void(0);" id="github-nav-button" class="nav-item" data-modal-target="githubModal" style="pointer-events: none; opacity: 0.5;">
        <i class="fab fa-github"></i> <span>GitHub</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="commentsModal">
        <i class="fas fa-comments"></i> <span>Discuss</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="about-modal">
        <i class="fas fa-user"></i>
        <span>About</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="contact-modal">
        <i class="fas fa-envelope"></i>
        <span>Contact</span>
      </a>
      <a href="javascript:void(0);" class="nav-item" data-modal-target="become-a-dev-modal">
        <i class="fas fa-code-branch"></i>
        <span>Become a Dev</span>
      </a>
    </nav>

    <!-- Hero Content -->
    <div class="hero-content">
      <h1 class="hero-title">Welcome to <span id="typing-target">Mike Lab</span></h1>
      <p class="hero-subtitle">
        <span id="dynamic-greeting" style="display: block; margin-bottom: 0.5rem; color: var(--accent-tertiary);"></span>
        Your one-stop shop for premium web applications, custom-built systems, and powerful developer tools. Browse our collection of ready-to-deploy solutions or hire an expert to bring your unique vision to life. Let's build the technology that drives your business forward.
      </p>
      
      <!-- Contact Information -->
      <div class="hero-contact">
        <p><i class="fas fa-envelope"></i> wrootmike@gmail.com</p>
        <p><i class="fas fa-phone"></i> 0792618156</p>
      </div>
      
      <!-- Custom Request Button - Prominent -->
      <div class="hero-cta">
        <a href="javascript:void(0);" data-modal-target="request-modal" class="btn btn-primary btn-custom-request">
          <i class="fas fa-rocket"></i>
          Request Custom System or App
        </a>
        <a href="#projects" class="btn btn-secondary">
          <i class="fas fa-eye"></i>
          View My Collection
        </a>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats">
      <div class="stat-card fade-in-element">
        <div class="stat-number" data-target="30">0</div>
        <div class="stat-label">Projects Completed</div>
        <div class="stat-trend">+5 this month</div>
      </div>
      <div class="stat-card fade-in-element">
        <div class="stat-number" data-target="50">0</div>
        <div class="stat-label">Happy Clients</div>
        <div class="stat-trend">98% satisfaction</div>
      </div>
      <div class="stat-card fade-in-element">
        <div class="stat-number" data-target="3">0</div>
        <div class="stat-label">Years Experience</div>
        <div class="stat-trend">Always learning</div>
      </div>
      <div class="stat-card fade-in-element">
        <div class="stat-number" data-target="24">0</div>
        <div class="stat-label">Support Hours</div>
        <div class="stat-trend">7 days a week</div>
      </div>
    </div>
  </section>

  <!-- Lab Experiments Section -->
  <section class="projects-section" id="projects">
    <div class="section-header">
      <h2 class="section-title">Lab Experiments</h2>
      <p class="section-subtitle">
        A showcase of active experiments, completed research, and open-source contributions.
      </p>
    </div>

    <div class="filters-container">
      <!-- Search -->
      <div class="search-container">
        <div class="search-input-wrapper">
          <i class="fas fa-search search-icon"></i>
          <input 
            type="text" 
            class="search-input" 
            placeholder="Search projects..." 
            id="project-search"
            autocomplete="off"
          />
          <button class="search-clear" id="search-clear" aria-label="Clear search">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <!-- Filters -->
      <div class="project-filters">
        <button class="filter-btn active" data-filter="all">
          <span>All Experiments</span>
          <span class="filter-count">30</span>
        </button>
        <button class="filter-btn" data-filter="active">
          <span> Active Experiments</span>
          <span class="filter-count">19</span>
        </button>
        <button class="filter-btn" data-filter="completed">
          <span> Completed Research</span>
          <span class="filter-count">1</span>
        </button>
        <button class="filter-btn" data-filter="concept">
          <span> Concepts</span>
          <span class="filter-count">10</span>
        </button>
        <button class="filter-btn" data-filter="open-source">
          <span> Open Source</span>
          <span class="filter-count">1</span>
        </button>
      </div>
    </div>

    <!-- Projects Container -->
    <div class="projects-container">
      <div class="projects-scroll" id="projects-scroll">
        <!-- Project cards will be dynamically inserted here -->
      </div>
    </div>
  </section>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>&copy; 2024 Mike Sites. All Rights Reserved.</p>
  </footer>

  <!-- Shopping Cart -->
  <div class="cart-container">
    <button class="cart-button" onclick="toggleCart()" aria-label="Shopping cart">
      <i class="fas fa-shopping-cart"></i>
      <span class="cart-count" id="cart-count">0</span>
    </button>

    <div class="cart-sidebar" id="cart-sidebar">
      <div class="cart-header">
        <h3 class="cart-title">Shopping Cart</h3>
        <button class="cart-close" onclick="toggleCart()" aria-label="Close cart">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="cart-items" id="cart-items">
        <div class="cart-empty">
          <i class="fas fa-shopping-cart"></i>
          <p>Your cart is empty</p>
          <p>Add some projects to get started!</p>
        </div>
      </div>
      
      <div class="cart-footer hidden" id="cart-footer">
        <div class="cart-total">
          <span>Total: </span>
          <span id="cart-total">KES 0</span>
        </div>
        <button class="cart-checkout" onclick="checkout()">
          <i class="fas fa-credit-card"></i>
          Proceed to Checkout
        </button>
      </div>
    </div>
  </div>

  <!-- Project Modal -->
  <div class="modal" id="project-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modal-title">Project Title</h2>
        <button class="modal-close" data-modal-close="project-modal" aria-label="Close modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="modal-gallery">
            <img src="https://via.placeholder.com/800x600" alt="Main project image" class="modal-main-image" id="modal-main-image">
            <div class="modal-thumbnails" id="modal-thumbnails">
                <!-- Thumbnails will be dynamically inserted here -->
            </div>
        </div>
        <div id="modal-details" class="modal-details">
          <!-- Project details will be dynamically inserted here -->
        </div>
      </div>
      <div class="modal-footer">
        <div class="modal-links">
          <a href="#" class="modal-link" id="modal-demo" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-external-link-alt"></i>
            <span id="modal-demo-text">Live Demo</span>
          </a>
          <a href="#" class="modal-link" id="modal-github" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-github"></i>
            View Code
          </a>
          <a href="#" class="modal-link" id="modal-download">
            <i class="fas fa-download"></i>
            Download Source
          </a>
          <a href="#" class="modal-link" id="modal-request-feature">
            <i class="fas fa-lightbulb"></i>
            Request Feature
          </a>
          <a href="#" class="modal-link" id="modal-report-bug">
            <i class="fas fa-bug"></i>
            Report Bug
          </a>
        </div>
         <div class="social-share">
          <h4>Share this project:</h4>
          <a href="javascript:void(0);" class="share-btn twitter" onclick="shareProject('twitter', this)"><i class="fab fa-twitter"></i> Twitter</a>
          <a href="javascript:void(0);" class="share-btn linkedin" onclick="shareProject('linkedin', this)"><i class="fab fa-linkedin-in"></i> LinkedIn</a>
          <a href="javascript:void(0);" class="share-btn facebook" onclick="shareProject('facebook', this)"><i class="fab fa-facebook-f"></i> Facebook</a>
        </div>
      </div>
    </div>
  </div>

  <!-- About Me Modal -->
  <div class="modal" id="about-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">About Me</h2>
        <button class="modal-close" data-modal-close="about-modal" aria-label="Close modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="about-modal-content">
          <img src="myk_logo.webp" alt="Mike - Photo" class="about-modal-image" loading="lazy"/>
          <h4 class="about-modal-name">Mike</h4>
          <p class="about-modal-bio">
            A passionate and results-driven Full-Stack Developer from Nairobi, Kenya. With 3 years of hands-on experience, I turn innovative ideas into robust, user-friendly web applications. My digital workshop, Mike Lab, is where I experiment with cutting-edge tech to solve tomorrow's problems today.
          </p>
          <div class="about-modal-footer">
            <p>Let's connect and build something amazing together!</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Contact Modal -->
  <div class="modal" id="contact-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Get In Touch</h2>
        <button class="modal-close" data-modal-close="contact-modal" aria-label="Close modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <p class="section-subtitle text-center mb-2">
          Ready to bring your vision to life? Let's discuss your project requirements and create something amazing together.
        </p>
        <div class="contact-container">
          <div class="contact-info">
            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <h3>Email</h3>
              <p>wrootmike@gmail.com</p>
            </div>

            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-phone"></i>
              </div>
              <h3>Phone</h3>
              <p>0792618156</p>
            </div>

            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <h3>Location</h3>
              <p>Nairobi, Kenya</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Download Modal -->
  <div class="modal" id="download-modal">
    <div class="modal-content modal-content--small">
      <div class="modal-header">
        <h2 class="modal-title">Download Source Code</h2>
        <button class="modal-close" data-modal-close="download-modal" aria-label="Close modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body modal-body--single-col">
          <p>Please enter the secret key to download the source code.</p>
          <input type="password" id="secret-key-input" placeholder="Secret Key" class="search-input form-input--spaced"/>
          <button class="btn btn-primary" onclick="handleDownload()">Submit</button>
      </div>
    </div>
  </div>

  <!-- Request Modal -->
  <div class="modal" id="request-modal">
    <div class="modal-content modal-content--large">
        <div class="modal-header">
            <h2 class="modal-title">Request a Custom System or App</h2>
        <button class="modal-close" data-modal-close="request-modal" aria-label="Close modal">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body modal-body--single-col">
            <p class="section-subtitle text-center mb-2">
                Have a specific idea in mind? Fill out the form below to get a quote.
            </p>
            <form id="request-form" class="request-form">
                <div class="form-group">
                    <label for="requester-name">Full Name</label>
                    <input type="text" id="requester-name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="requester-email">Email Address</label>
                    <input type="email" id="requester-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="project-type">Project Type</label>
                    <select id="project-type" name="project-type" required>
                        <option value="">Select a project type</option>
                        <option value="web-app">Web Application</option>
                        <option value="mobile-app">Mobile App</option>
                        <option value="desktop-app">Desktop App</option>
                        <option value="automation-script">Automation Script</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="project-description">Project Description</label>
                    <textarea id="project-description" name="description" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="project-budget">Estimated Budget (KES)</label>
                    <input type="number" id="project-budget" name="budget" placeholder="e.g., 50000">
                </div>
                <button type="submit" class="btn btn-primary btn--full-width">Submit Request</button>
            </form>
        </div>
    </div>
  </div>

<!-- ================================================================================= -->
<!-- GENERATED PLACEHOLDER MODALS -->
<!-- ================================================================================= -->

<!-- Become a Dev Modal -->
<div class="modal" id="become-a-dev-modal">
  <div class="modal-content modal-content--large">
    <div class="modal-header">
      <h2 class="modal-title">Become a Developer</h2>
      <button class="modal-close" data-modal-close="become-a-dev-modal" aria-label="Close modal"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body modal-body--single-col" id="become-a-dev-body">
      <p class="section-subtitle text-center" style="margin-bottom: 2rem;">
        Start your journey into software development. Here are some popular languages, from newest to oldest.
      </p>
      <div class="learning-grid" id="learning-grid-container">
        <!-- Languages will be dynamically inserted here -->
      </div>
    </div>
  </div>
</div>

<!-- Scraper Results Modal -->
<div class="modal" id="scraper-results-modal">
  <div class="modal-content modal-content--large">
    <div class="modal-header">
      <h2 class="modal-title">Scraper Results</h2>
      <button class="modal-close" data-modal-close="scraper-results-modal" aria-label="Close modal"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body modal-body--single-col" id="scraper-results-body">
      <p id="scraper-results-status">Loading...</p>
      <div id="scraper-results-content"></div>
    </div>
  </div>
</div>

<!-- Blog Modal -->
<div class="modal" id="blogModal">
  <div class="modal-content modal-content--large">
    <div class="modal-header">
      <h2 class="modal-title">Blog Generator</h2>
      <button class="modal-close" data-modal-close="blogModal" aria-label="Close modal"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body" id="blog-generator-body">
        <style>
            #blog-generator-body {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 2rem;
                overflow-y: auto; /* Make this container scrollable */
                padding: 1.5rem; /* Add some padding */
                flex-grow: 1; /* Allow it to fill available space */
                min-height: 0; /* Important fix for flexbox scrolling */
            }
            .template-selector {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                margin-bottom: 1.5rem;
            }
            .template-card {
                border: 2px solid var(--border-color);
                border-radius: 8px;
                padding: 0.5rem;
                cursor: pointer;
                transition: all 0.3s ease;
                background: var(--bg-tertiary);
            }
            .template-card.selected {
                border-color: var(--accent-primary);
                box-shadow: 0 0 10px var(--shadow-color);
            }
            .template-card:hover {
                transform: translateY(-5px);
            }
            .template-card img {
                width: 100%;
                height: auto;
                border-radius: 4px;
                aspect-ratio: 16/9;
                object-fit: cover;
            }
            .template-card p {
                text-align: center;
                font-weight: 500;
                margin: 0.5rem 0 0;
                font-size: 0.9rem;
            }
            .generator-actions {
                display: flex;
                gap: 1rem;
            }
            #preview-area {
                margin-top: 1.5rem;
                border: 1px solid var(--border-color);
                border-radius: 8px;
                height: 200px; /* Or some other appropriate height */
                display: flex;
                align-items: center;
                justify-content: center;
                background: var(--bg-primary);
            }
            #preview-iframe {
                width: 100%;
                height: 100%;
                border: none;
                border-radius: 8px;
            }
             .generator-form .form-group {
                margin-bottom: 1rem;
            }
            @media (max-width: 992px) {
                #blog-generator-body {
                    grid-template-columns: 1fr;
                    height: auto;
                }
                .generator-form, .generator-preview-area {
                    overflow-y: visible;
                    padding-right: 0;
                }
            }
        </style>
        <div class="generator-form">
            <h3><i class="fas fa-pencil-alt"></i> Content</h3>
            <div class="form-group">
                <label for="blog-title">Blog Title</label>
                <input type="text" id="blog-title" class="search-input" placeholder="My Awesome Blog">
            </div>
            <div class="form-group">
                <label for="author-name">Author Name</label>
                <input type="text" id="author-name" class="search-input" placeholder="John Doe">
            </div>
            <div class="form-group">
                <label for="author-bio">Author Bio (for supported templates)</label>
                <textarea id="author-bio" class="search-input" rows="2" placeholder="A short bio about the author."></textarea>
            </div>
            <hr style="margin: 2rem 0; border-color: var(--border-color);">
            <h3><i class="fas fa-file-alt"></i> First Post</h3>
            <div class="form-group">
                <label for="post-title">Post Title</label>
                <input type="text" id="post-title" class="search-input" placeholder="My First Post">
            </div>
            <div class="form-group">
                <label for="post-image-url">Header Image URL (for creative template)</label>
                <input type="text" id="post-image-url" class="search-input" placeholder="https://via.placeholder.com/800x400">
            </div>
            <div class="form-group">
                <label for="post-content">Post Content (Markdown supported)</label>
                <textarea id="post-content" class="search-input" rows="6" placeholder="Write your blog post here..."></textarea>
            </div>
        </div>
        <div class="generator-preview-area">
            <h3><i class="fas fa-th-large"></i> Template</h3>
            <div class="template-selector">
                <div class="template-card selected" data-template="1" title="Minimalist">
                    <img src="myk_thumb_1.png" alt="Minimalist Template">
                    <p>Minimalist</p>
                </div>
                <div class="template-card" data-template="2" title="Professional">
                    <img src="myk_thumb_2.png" alt="Professional Template">
                    <p>Professional</p>
                </div>
                <div class="template-card" data-template="3" title="Creative">
                    <img src="myk_thumb_3.png" alt="Creative Template">
                    <p>Creative</p>
                </div>
                <div class="template-card" data-template="4" title="Tech/Dark">
                    <img src="myk_thumb_4.png" alt="Tech/Dark Template">
                    <p>Tech/Dark</p>
                </div>
            </div>
            <div class="generator-actions">
                <button id="preview-blog-btn" class="btn btn-secondary" style="width: 100%;"><i class="fas fa-eye"></i> Preview</button>
                <button id="download-blog-btn" class="btn btn-primary" style="width: 100%;"><i class="fas fa-download"></i> Download</button>
            </div>
            <div id="preview-area">
                <iframe id="preview-iframe" title="Blog Preview"></iframe>
            </div>
        </div>
    </div>
  </div>
</div>

<!-- Tools Modal -->
<div class="modal" id="toolsModal">
    <div class="modal-content modal-content--large">
        <div class="modal-header">
            <h2 class="modal-title">Developer Toolkit</h2>
            <button class="modal-close" data-modal-close="toolsModal" aria-label="Close modal"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body modal-body--single-col" id="tools-modal-body">
            <h3 class="tool-group-title">Text Utilities</h3>
            <div class="tool-grid">
                <!-- JSON Formatter -->
                <div class="tool-card">
                    <h3><i class="fas fa-code"></i> JSON Formatter & Validator</h3>
                    <div class="form-group">
                        <textarea id="json-input" class="search-input" rows="8" placeholder="Paste your JSON here..."></textarea>
                    </div>
                    <div class="tool-actions">
                        <button class="btn btn-secondary" onclick="formatJSON()"><i class="fas fa-align-left"></i> Format</button>
                        <button class="btn btn-secondary" onclick="minifyJSON()"><i class="fas fa-compress-arrows-alt"></i> Minify</button>
                        <button class="btn btn-secondary" onclick="copyToClipboard('json-input')"><i class="fas fa-copy"></i> Copy</button>
                    </div>
                    <p id="json-status" class="tool-status"></p>
                </div>

                <!-- Character/Word Counter -->
                <div class="tool-card">
                    <h3><i class="fas fa-calculator"></i> Character & Word Counter</h3>
                    <div class="form-group">
                        <textarea id="text-counter-input" class="search-input" rows="6" placeholder="Type or paste text here..."></textarea>
                    </div>
                    <div class="counter-results">
                        <span>Words: <strong id="word-count">0</strong></span>
                        <span>Characters: <strong id="char-count">0</strong></span>
                    </div>
                </div>

                <!-- Base64 Encoder/Decoder -->
                <div class="tool-card">
                    <h3><i class="fas fa-exchange-alt"></i> Base64 Encoder/Decoder</h3>
                    <div class="form-group">
                        <label for="base64-input">Text</label>
                        <textarea id="base64-input" class="search-input" rows="3" placeholder="Input for encoding/decoding"></textarea>
                    </div>
                    <div class="tool-actions">
                        <button class="btn btn-secondary" onclick="base64Encode()"><i class="fas fa-arrow-down"></i> Encode</button>
                        <button class="btn btn-secondary" onclick="base64Decode()"><i class="fas fa-arrow-up"></i> Decode</button>
                    </div>
                    <div class="form-group">
                        <label for="base64-output">Base64</label>
                        <textarea id="base64-output" class="search-input" rows="3" placeholder="Output"></textarea>
                    </div>
                </div>
            </div>

            <h3 class="tool-group-title">Web &amp; AI Tools</h3>
            <div class="tool-grid">
                <!-- Web Scraper -->
                <div class="tool-card">
                    <h3><i class="fas fa-robot"></i> AI Web Scraper</h3>
                    <div class="form-group">
                        <label for="scraper-url">Website URL</label>
                        <input type="url" id="scraper-url" class="search-input" placeholder="https://example.com">
                    </div>
                    <div class="form-group">
                        <label for="scraper-query">What to search for (e.g., "all product titles")</label>
                        <input type="text" id="scraper-query" class="search-input" placeholder="e.g., all product titles">
                    </div>
                    <div class="tool-actions">
                        <button class="btn btn-primary" onclick="handleScrape()"><i class="fas fa-search-location"></i> Scrape</button>
                    </div>
                    <p id="scraper-status" class="tool-status"></p>
                </div>

                <!-- URL Transcriber -->
                <div class="tool-card">
                    <h3><i class="fas fa-microphone-alt"></i> URL Transcriber</h3>
                    <div class="form-group">
                        <label for="transcriber-url">URL to Transcribe</label>
                        <input type="url" id="transcriber-url" class="search-input" placeholder="https://example.com/audio.mp3">
                    </div>
                    <div class="tool-actions">
                        <button id="transcribe-btn" class="btn btn-primary"><i class="fas fa-file-audio"></i> Transcribe</button>
                    </div>
                    <p id="transcriber-status" class="tool-status"></p>
                    <div class="form-group">
                        <label for="transcriber-output">Transcription</label>
                        <textarea id="transcriber-output" class="search-input" rows="6" placeholder="Transcription will appear here..." readonly></textarea>
                    </div>
                </div>
            </div>

            <h3 class="tool-group-title">Design Tools</h3>
            <div class="tool-grid">
                <!-- Color Converter -->
                <div class="tool-card">
                    <h3><i class="fas fa-palette"></i> Color Converter</h3>
                    <div class="color-converter-grid">
                        <div class="form-group">
                            <label for="color-hex">HEX</label>
                            <input type="text" id="color-hex" class="search-input" placeholder="#ffffff">
                        </div>
                        <div class="form-group">
                            <label for="color-rgb">RGB</label>
                            <input type="text" id="color-rgb" class="search-input" placeholder="rgb(255, 255, 255)">
                        </div>
                        <div class="form-group">
                            <label for="color-hsl">HSL</label>
                            <input type="text" id="color-hsl" class="search-input" placeholder="hsl(0, 0%, 100%)">
                        </div>
                    </div>
                    <div class="color-preview-wrapper">
                        <div id="color-preview" class="color-preview"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Changelog Modal -->
<div class="modal" id="changelogModal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">Changelog</h2>
      <button class="modal-close" data-modal-close="changelogModal" aria-label="Close modal"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
        <style>
            #changelogModal .version { margin-bottom: 1.5rem; }
            #changelogModal h4 { font-size: 1.2rem; color: var(--accent-primary); margin-bottom: 0.75rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); }
            #changelogModal ul { list-style: none; padding-left: 1rem; }
            #changelogModal li { margin-bottom: 0.5rem; position: relative; padding-left: 5px; }
            #changelogModal li::before { content: ''; color: var(--accent-primary); position: absolute; left: -1rem; }
            #changelogModal .tag { font-size: 0.7rem; padding: 0.2rem 0.5rem; border-radius: 10px; margin-right: 0.5rem; color: var(--bg-primary); font-weight: bold; text-transform: uppercase; }
            #changelogModal .tag-fix { background-color: var(--warning-color); }
            #changelogModal .tag-feat { background-color: var(--success-color); }
        </style>
        <div class="version">
            <h4>Version 1.2.1 <span style="font-size: 0.9rem; color: var(--text-secondary);">(Current)</span></h4>
            <ul>
                <li><span class="tag tag-feat">Feature</span>Implemented content for the 'Technical Specifications' modal.</li>
            </ul>
        </div>
        <div class="version">
            <h4>Version 1.2.0</h4>
            <ul>
                <li><span class="tag tag-feat">Feature</span>Added 8 placeholder modals for previously inactive navigation links to improve UX.</li>
            </ul>
        </div>
        <div class="version">
            <h4>Version 1.1.0</h4>
            <ul>
                <li><span class="tag tag-fix">Fix</span>Resolved critical JavaScript errors that prevented modals from opening.</li>
                <li><span class="tag tag-fix">Fix</span>Defined several missing helper functions to prevent script crashes.</li>
            </ul>
        </div>
        <div class="version">
            <h4>Version 1.0.0</h4>
            <ul>
                <li>Initial release of the Mike Lab portfolio.</li>
            </ul>
        </div>
    </div>
  </div>
</div>

<!-- Tech Specs Modal -->
<div class="modal" id="techSpecsModal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">Technical Specifications</h2>
      <button class="modal-close" data-modal-close="techSpecsModal" aria-label="Close modal"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
        <style>
            #techSpecsModal ul { list-style: none; padding-left: 0; margin-bottom: 1.5rem; }
            #techSpecsModal li { display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem; line-height: 1.5; }
            #techSpecsModal i { color: var(--accent-primary); width: 20px; text-align: center; margin-top: 4px; }
            #techSpecsModal h4 { margin: 1.5rem 0 1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
            #techSpecsModal h4:first-child { margin-top: 0; }
        </style>
        <h4>Core Technologies</h4>
        <ul>
            <li><i class="fab fa-html5"></i><div><strong>HTML5:</strong> For the core structure and semantic content.</div></li>
            <li><i class="fab fa-css3-alt"></i><div><strong>CSS3:</strong> For all styling, animations, and responsive design, using modern features like Custom Properties and Flexbox.</div></li>
            <li><i class="fab fa-js-square"></i><div><strong>Vanilla JavaScript (ES6+):</strong> For all interactivity, including project filtering and dynamic content rendering, with no external frameworks.</div></li>
        </ul>

        <h4>External Libraries & APIs</h4>
        <ul>
            <li><i class="fas fa-font-awesome"></i><div><strong>Font Awesome:</strong> For the rich icon set used throughout the site.</div></li>
            <li><i class="fas fa-font"></i><div><strong>Google Fonts:</strong> For the 'Poppins' typeface to ensure modern typography.</div></li>
            <li><i class="fas fa-cogs"></i><div><strong>Fetch API:</strong> Used to dynamically load project data from the <code>projects.json</code> file.</div></li>
            <li><i class="fas fa-eye"></i><div><strong>Intersection Observer API:</strong> For performant, power-efficient scroll-based animations.</div></li>
        </ul>

        <h4>Development & Design Principles</h4>
        <ul>
            <li><i class="fas fa-file-alt"></i><div><strong>Single-Page Application (SPA):</strong> The entire experience is delivered in a single, fast-loading HTML file.</div></li>
            <li><i class="fas fa-mobile-alt"></i><div><strong>Responsive Design:</strong> The layout adapts seamlessly to various screen sizes, from mobile to desktop.</div></li>
            <li><i class="fas fa-universal-access"></i><div><strong>Accessibility:</strong> Includes features like a skip link, ARIA labels, and semantic HTML for better screen reader support.</div></li>
        </ul>
    </div>
  </div>
</div>

<!-- Currently Learning Modal -->
<div class="modal" id="currentlyLearningModal">
    <div class="modal-content modal-content--large">
        <div class="modal-header">
            <h2 class="modal-title">My Learning Journey</h2>
            <button class="modal-close" data-modal-close="currentlyLearningModal" aria-label="Close modal"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body modal-body--single-col" id="learning-modal-body">
            <p class="section-subtitle text-center" style="margin-bottom: 2rem;">
                I believe in lifelong learning. Here's a look at the technologies and concepts I'm currently focused on.
            </p>
            <div class="learning-grid">
                <!-- Core Focus -->
                <div class="learning-category">
                    <h3 class="learning-category-title"><i class="fas fa-bullseye"></i> Core Focus</h3>
                    <div class="learning-item">
                        <div class="learning-item-header">
                            <i class="fas fa-cogs"></i>
                            <h4>Advanced Backend Engineering</h4>
                        </div>
                        <p>Deepening my understanding of microservices architecture, message queues (like RabbitMQ), and advanced database optimization techniques for large-scale applications.</p>
                        <div class="learning-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 70%;"></div>
                            </div>
                            <span>70% (Applying)</span>
                        </div>
                    </div>
                    <div class="learning-item">
                        <div class="learning-item-header">
                            <i class="fas fa-cloud"></i>
                            <h4>Cloud-Native & DevOps</h4>
                        </div>
                        <p>Mastering containerization with Docker, orchestration with Kubernetes, and building robust CI/CD pipelines using GitHub Actions to automate testing and deployment.</p>
                        <div class="learning-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 55%;"></div>
                            </div>
                            <span>55% (Intermediate)</span>
                        </div>
                    </div>
                </div>

                <!-- Expanding Knowledge -->
                <div class="learning-category">
                    <h3 class="learning-category-title"><i class="fas fa-brain"></i> Expanding Knowledge</h3>
                    <div class="learning-item">
                        <div class="learning-item-header">
                            <i class="fas fa-robot"></i>
                            <h4>Applied Machine Learning</h4>
                        </div>
                        <p>Exploring practical applications of machine learning, including natural language processing (NLP) with transformers and deploying models as APIs using Python frameworks.</p>
                        <div class="learning-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 40%;"></div>
                            </div>
                            <span>40% (Exploring)</span>
                        </div>
                    </div>
                     <div class="learning-item">
                        <div class="learning-item-header">
                            <i class="fas fa-cube"></i>
                            <h4>WebAssembly (WASM)</h4>
                        </div>
                        <p>Investigating how to leverage WebAssembly with Rust to bring near-native performance to web applications for computationally intensive tasks.</p>
                        <div class="learning-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 25%;"></div>
                            </div>
                            <span>25% (Foundational)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- GitHub Modal -->
<div class="modal" id="githubModal">
  <div class="modal-content modal-content--large">
    <div class="modal-header">
      <h2 class="modal-title">GitHub Repositories</h2>
      <button class="modal-close" data-modal-close="githubModal" aria-label="Close modal"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body modal-body--single-col" id="github-modal-body">
      <div id="github-repo-list">
        <!-- Repository list will be dynamically inserted here -->
      </div>
    </div>
  </div>
</div>

<!-- Comments Modal -->
<div class="modal" id="commentsModal">
  <div class="modal-content modal-content--large">
    <div class="modal-header">
      <h2 class="modal-title">Discussion</h2>
      <button class="modal-close" data-modal-close="commentsModal" aria-label="Close modal"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body modal-body--single-col" id="comments-modal-body">
        <div class="comment-form-container">
            <form id="comment-form" class="request-form" style="gap: 1rem;">
                <p class="section-subtitle" style="text-align: center; margin-bottom: 1rem;">Join the discussion! Comments are temporary and reset on page load.</p>
                <div class="form-group">
                    <label for="commenter-name">Name</label>
                    <input type="text" id="commenter-name" required placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label for="comment-text">Comment</label>
                    <textarea id="comment-text" rows="3" required placeholder="Share your thoughts..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn--full-width">Submit Comment</button>
            </form>
        </div>
        <div class="comment-list-container">
            <h3 class="modal-section-title" style="margin-top: 2rem;">Comments</h3>
            <div id="comment-list">
                <!-- Comments will be rendered here -->
            </div>
        </div>
    </div>
  </div>
</div>

<script>
// =================================================================================
// MAIN APP LOGIC
// =================================================================================

let projects = [];

// Shopping cart functionality
let cart = [];
let currentFilter = 'all';
let animationObserver;

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
  initializeScrollAnimations();

  fetch('projects.json')
    .then(response => response.json())
    .then(data => {
      projects = data;
      renderProjects();
      const githubButton = document.getElementById('github-nav-button');
      if (githubButton) {
          githubButton.style.pointerEvents = 'auto';
          githubButton.style.opacity = '1';
      }
    })
    .catch(error => console.error('Error fetching projects:', error));

  animateStats();
  loadTheme();
  updateClock();
  setInterval(updateClock, 1000);
  initializeEventListeners();
  renderLanguages();
  setDynamicGreeting();

  const typingTarget = document.getElementById('typing-target');
  if (typingTarget) {
      const words = ['Mike Lab', 'Your Vision', 'The Future'];
      typeAnimation(typingTarget, words);
  }
});

function renderLanguages() {
  fetch('languages.json')
    .then(response => response.json())
    .then(languages => {
      const container = document.getElementById('learning-grid-container');
      if (!container) return;

      // Sort languages by year, descending
      languages.sort((a, b) => b.year - a.year);

      container.innerHTML = languages.map(lang => `
        <div class="learning-item">
          <div class="learning-item-header">
            <i class="${lang.icon || 'fas fa-code'}"></i>
            <h4>${lang.name} (${lang.year})</h4>
          </div>
          <p>${lang.description}</p>
          <a href="${lang.youtube_link}" target="_blank" rel="noopener noreferrer" class="btn btn-primary">
            <i class="fab fa-youtube"></i>
            Watch Tutorial
          </a>
        </div>
      `).join('');
    })
    .catch(error => {
      console.error('Error fetching languages:', error);
      const container = document.getElementById('learning-grid-container');
      if (container) {
        container.innerHTML = '<p style="color: var(--error-color);">Could not load learning resources at this time.</p>';
      }
    });
}

// =================================================================================
// INITIALIZATION AND EVENT LISTENERS
// =================================================================================

function initializeScrollAnimations() {
  animationObserver = new IntersectionObserver((entries, observer) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.1 });

  const staticElements = document.querySelectorAll('.fade-in-element');
  staticElements.forEach(el => animationObserver.observe(el));
}

function initializeEventListeners() {
  // Template Selector
  const templateSelector = document.querySelector('.template-selector');
  if (templateSelector) {
    templateSelector.addEventListener('click', (e) => {
        const card = e.target.closest('.template-card');
        if (!card) return;

        document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
    });
  }

  // Blog Generator Preview Button
  const previewBtn = document.getElementById('preview-blog-btn');
  if (previewBtn) {
      previewBtn.addEventListener('click', generateBlogPreview);
  }

  // Blog Generator Download Button
  const downloadBtn = document.getElementById('download-blog-btn');
  if (downloadBtn) {
      downloadBtn.addEventListener('click', downloadBlogAsZip);
  }

  // Search
  document.getElementById('project-search').addEventListener('input', handleSearch);
  document.getElementById('search-clear').addEventListener('click', clearSearch);
  
  // Filters
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', handleFilter);
  });
  
  // Navigation
  document.querySelectorAll('.nav-item[href^="#"]').forEach(item => {
    item.addEventListener('click', handleNavigation);
  });
  
  // Keyboard navigation
  document.addEventListener('keydown', handleKeyboard);

  // Request form submission
  const requestForm = document.getElementById('request-form');
  if (requestForm) {
      requestForm.addEventListener('submit', handleRequestSubmission);
  }

  // Touch support for project cards
  if ('ontouchstart' in window) {
    document.addEventListener('touchstart', function(e) {
      if (e.target.closest('.project-card')) {
        e.target.closest('.project-card').style.transform = 'scale(0.98)';
      }
    });

    document.addEventListener('touchend', function(e) {
      if (e.target.closest('.project-card')) {
        e.target.closest('.project-card').style.transform = '';
      }
    });
  }

  // Unified modal close handler
  document.addEventListener('click', function(event) {
    if (event.target.classList.contains('modal')) {
        closeModalById(event.target.id);
    }
  });

  // Comment form submission
  const commentForm = document.getElementById('comment-form');
  if (commentForm) {
      commentForm.addEventListener('submit', handleCommentSubmit);
  }

  // Modal open/close listeners
  document.addEventListener('click', function(event) {
    const openTrigger = event.target.closest('[data-modal-target]');
    if (openTrigger) {
      const modalId = openTrigger.dataset.modalTarget;
      openModalById(modalId, event);
    }

    const closeTrigger = event.target.closest('[data-modal-close]');
    if (closeTrigger) {
      const modalId = closeTrigger.dataset.modalClose;
      closeModalById(modalId);
    }
  });
}

// =================================================================================
// UI AND ANIMATION
// =================================================================================

function animateStats() {
  const statNumbers = document.querySelectorAll('.stat-number');
  
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const target = parseInt(entry.target.dataset.target);
        animateNumber(entry.target, target);
        observer.unobserve(entry.target);
      }
    });
  });
  
  statNumbers.forEach(stat => observer.observe(stat));
}

function animateNumber(element, target) {
  let current = 0;
  const increment = target / 50;
  const timer = setInterval(() => {
    current += increment;
    if (current >= target) {
      current = target;
      clearInterval(timer);
    }
    element.textContent = Math.floor(current);
  }, 30);
}

function handleSearch(event) {
  const searchTerm = event.target.value.toLowerCase();
  const clearButton = document.getElementById('search-clear');

  const projectsToRender = projects.filter(project =>
    project.title.toLowerCase().includes(searchTerm) ||
    project.description.toLowerCase().includes(searchTerm) ||
    project.tags.some(tag => tag.toLowerCase().includes(searchTerm))
  );
  renderProjects(projectsToRender);

  if (searchTerm) {
    clearButton.classList.add('visible');
  } else {
    clearButton.classList.remove('visible');
  }
}

function clearSearch() {
  const searchInput = document.getElementById('project-search');
  searchInput.value = '';
  renderProjects(projects);
  document.getElementById('search-clear').classList.remove('visible');
}

function handleFilter(event) {
  const filter = event.currentTarget.dataset.filter;

  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  event.currentTarget.classList.add('active');

  currentFilter = filter;

  let projectsToRender;
  if (filter === 'all') {
    projectsToRender = projects;
  } else if (filter === 'active') {
    projectsToRender = projects.filter(p => p.status === 'ongoing' || p.status === 'construction');
  } else if (filter === 'completed') {
    projectsToRender = projects.filter(p => p.status === 'live');
  } else {
    projectsToRender = projects.filter(p => p.category === filter);
  }

  renderProjects(projectsToRender);
}

function handleNavigation(event) {
  const targetId = event.currentTarget.getAttribute('href');
  if (!targetId || targetId === '#') {
    return;
  }
  event.preventDefault();

  const targetElement = document.querySelector(targetId);
  if (targetElement) {
    targetElement.scrollIntoView({
      behavior: 'smooth',
      block: 'start'
    });

    document.querySelectorAll('.nav-item').forEach(item => {
      item.classList.remove('active');
    });
    event.currentTarget.classList.add('active');
  }
}

function renderProjects(projectsToRender = projects) {
  const container = document.getElementById('projects-scroll');
  
  if (projectsToRender.length === 0) {
    container.innerHTML = `
      <div class="no-results" style="text-align: center; padding: 3rem; color: var(--text-secondary);">
        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
        <h3>No projects found</h3>
        <p>Try adjusting your search or filter criteria.</p>
      </div>
    `;
    return;
  }
  
  container.innerHTML = projectsToRender.map(project => {
    const statusIcon = getStatusIcon(project.status);
    const statusText = getStatusText(project.status);
    const progressBar = project.status === 'ongoing' ? `
      <div class="progress-container">
        <div class="progress-label">
          <span>Progress</span>
          <span>${project.progress}%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${project.progress}%"></div>
        </div>
      </div>
    ` : '';
    
    const isDemoAvailable = project.demo && project.demo !== '#';
    const isGithubAvailable = project.github && project.github !== '#';

    const infoButton = `<button class="add-to-cart" onclick="openProjectModal(${project.id})"><i class="fas fa-info-circle"></i> Info</button>`;
    const demoButton = `<a href="${project.demo || '#'}" target="_blank" rel="noopener noreferrer" class="add-to-cart ${!isDemoAvailable ? 'disabled' : ''}" onclick="if(!${isDemoAvailable}) event.preventDefault(); event.stopPropagation();"><i class="fas fa-eye"></i> Demo</a>`;
    const codeButton = `<a href="${project.github || '#'}" target="_blank" rel="noopener noreferrer" class="add-to-cart ${!isGithubAvailable ? 'disabled' : ''}" onclick="if(!${isGithubAvailable}) event.preventDefault(); event.stopPropagation();"><i class="fab fa-github"></i> Code</a>`;
    const actionButton = getActionButton(project);

    return `
      <div class="project-card fade-in-element" data-category="${project.category}">
        <div class="project-image" onclick="openProjectModal(${project.id})">
          <img class="project-thumbnail" src="${project.image}" alt="${project.title}" loading="lazy"/>
          <div class="project-status status-${project.status}">
            ${statusIcon} ${statusText}
          </div>
        </div>
        <div class="project-content">
          <h3 class="project-title">${project.title}</h3>
          <div class="project-date">${formatDate(project.date)}</div>
          <p class="project-description">${project.description}</p>
          ${progressBar}
          <div class="project-tags">
            ${project.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
          </div>
          <div class="project-footer">
            <div class="project-price">KES ${project.price.toLocaleString()}</div>
            <div class="project-actions">
                ${infoButton}
                ${demoButton}
                ${codeButton}
                ${actionButton}
            </div>
          </div>
        </div>
      </div>
    `;
  }).join('');

  const dynamicElements = container.querySelectorAll('.project-card.fade-in-element');
  dynamicElements.forEach(el => {
    if (animationObserver) {
      animationObserver.observe(el);
    }
  });
}

function getStatusIcon(status) {
  const icons = { live: '', ongoing: '', concept: '', construction: '' };
  return icons[status] || '';
}

function getStatusText(status) {
  const texts = { live: 'LIVE', ongoing: 'IN DEVELOPMENT', concept: 'CONCEPT', construction: 'UNDER CONSTRUCTION' };
  return texts[status] || 'UNKNOWN';
}

function getActionButton(project) {
  const actions = {
    live: { label: 'Purchase', icon: 'fa-download' },
    ongoing: { label: 'Pre-order', icon: 'fa-clock' },
    concept: { label: 'Reserve', icon: 'fa-bookmark' },
    construction: { label: 'Join Waitlist', icon: 'fa-bell' }
  };
  const action = actions[project.status];
  
  if (action) {
    return `<button class="add-to-cart" onclick="addToCart(event, ${project.id})" aria-label="${action.label} ${project.title}">
      <i class="fas ${action.icon}"></i>
      ${action.label}
    </button>`;
  }
  return `<button class="add-to-cart" disabled><i class="fas fa-question"></i> Unavailable</button>`;
}

// =================================================================================
// MODAL HANDLING
// =================================================================================

function openModalById(modalId, event, downloadProjectId = null) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    const modal = document.getElementById(modalId);
    if (!modal) return;

    modal.classList.add('active');
    document.body.style.overflow = 'hidden';

    // Special handling for certain modals
    if (modalId === 'download-modal' && downloadProjectId) {
        currentProjectIdForDownload = downloadProjectId;
        const project = projects.find(p => p.id === currentProjectIdForDownload);
        if (!project || !project.github || project.github === '#') {
            closeModalById(modalId);
            showNotification('Source code is not available for this project.', 'warning');
            return;
        }
        document.getElementById('secret-key-input').focus();
    } else if (modalId === 'codePlaygroundModal') {
        runCode();
    } else if (modalId === 'githubModal') {
        renderGithubRepositories();
    } else if (modalId === 'commentsModal') {
        renderComments();
    }
}

function closeModalById(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.remove('active');
    }
    // Only restore scroll if no other modals are active
    if (document.querySelectorAll('.modal.active').length === 0) {
        document.body.style.overflow = '';
    }
}

// Typing Animation
function typeAnimation(targetElement, words, typeSpeed = 100, deleteSpeed = 50, delay = 2000) {
    let wordIndex = 0;
    let charIndex = 0;
    let isDeleting = false;

    function type() {
        const currentWord = words[wordIndex];
        const currentChars = isDeleting ? currentWord.substring(0, charIndex - 1) : currentWord.substring(0, charIndex + 1);

        targetElement.textContent = currentChars;
        targetElement.style.borderRight = '2px solid var(--accent-primary)';


        if (!isDeleting && charIndex < currentWord.length) {
            charIndex++;
            setTimeout(type, typeSpeed);
        } else if (isDeleting && charIndex > 0) {
            charIndex--;
            setTimeout(type, deleteSpeed);
        } else {
            isDeleting = !isDeleting;
            if (!isDeleting) {
                wordIndex = (wordIndex + 1) % words.length;
            }
            setTimeout(type, isDeleting ? delay / 2 : delay);
        }
    }
    type();
}

function setDynamicGreeting() {
    const greetingElement = document.getElementById('dynamic-greeting');
    if (!greetingElement) return;

    const hour = new Date().getHours();
    let greeting;

    if (hour < 12) {
        greeting = 'Good Morning!';
    } else if (hour < 18) {
        greeting = 'Good Afternoon!';
    } else {
        greeting = 'Good Evening!';
    }

    greetingElement.textContent = greeting;
}

function openProjectModal(projectId) {
  const project = projects.find(p => p.id === projectId);
  if (!project) return;

  // Set basic info
  document.getElementById('modal-title').textContent = project.title;

  // Populate Gallery
  const mainImage = document.getElementById('modal-main-image');
  const thumbnailsContainer = document.getElementById('modal-thumbnails');

  thumbnailsContainer.innerHTML = ''; // Clear old thumbnails

  const galleryImages = (project.thumbnails && project.thumbnails.length > 0) ? project.thumbnails : [project.image];
  
  mainImage.src = galleryImages[0];

  galleryImages.forEach((thumbSrc, index) => {
    const thumb = document.createElement('img');
    thumb.src = thumbSrc;
    thumb.alt = `${project.title} thumbnail ${index + 1}`;
    thumb.classList.add('modal-thumbnail');
    if (index === 0) {
      thumb.classList.add('active');
    }
    thumb.onclick = () => {
      mainImage.src = thumbSrc;
      thumbnailsContainer.querySelectorAll('.modal-thumbnail').forEach(t => t.classList.remove('active'));
      thumb.classList.add('active');
    };
    thumbnailsContainer.appendChild(thumb);
  });

  // Populate Details
  const detailsContainer = document.getElementById('modal-details');

  // Timeline Info
  let timelineHTML = '';
  if (project.date) {
      timelineHTML += `<li><i class="fas fa-calendar-alt"></i><div><strong>Started:</strong> ${formatDate(project.date)}</div></li>`;
  }
  if (project.estimatedCompletion) {
      timelineHTML += `<li><i class="fas fa-flag-checkered"></i><div><strong>Est. Completion:</strong> ${formatDate(project.estimatedCompletion)}</div></li>`;
  }
   if (project.expectedLaunch) {
      timelineHTML += `<li><i class="fas fa-rocket"></i><div><strong>Est. Launch:</strong> ${project.expectedLaunch}</div></li>`;
  }
  if (timelineHTML) {
      timelineHTML = `<h4 class="modal-section-title">Project Timeline</h4><ul class="modal-features-list">${timelineHTML}</ul>`;
  }

  // Features
  let featuresHTML = project.features ? `
    <h4 class="modal-section-title">Key Features</h4>
    <ul class="modal-features-list">
      ${project.features.map(feature => `<li><i class="fas fa-check-circle"></i> ${feature}</li>`).join('')}
    </ul>` : '';
  
  // Progress Bar
  let progressHTML = (project.status === 'ongoing' && project.progress) ? `
    <div class="progress-container">
      <div class="progress-label"><span>Progress</span><span>${project.progress}%</span></div>
      <div class="progress-bar"><div class="progress-fill" style="width: ${project.progress}%"></div></div>
    </div>` : '';

  // Action button
  const actionButtonHTML = getActionButton(project);

  // Assemble details HTML
  detailsContainer.innerHTML = `
    <div class="modal-status status-${project.status}">${getStatusIcon(project.status)} ${getStatusText(project.status)}</div>
    <p class="modal-description">${project.description}</p>
    <div class="modal-price-tag">
        <div>
            <span class="price-label" style="display: block; font-size: 0.8rem; color: var(--text-secondary);">Price</span>
            <span class="price-value">KES ${project.price.toLocaleString()}</span>
        </div>
        ${actionButtonHTML}
    </div>
    ${progressHTML}
    ${timelineHTML}
    <h4 class="modal-section-title">Skills & Technologies</h4>
    <div class="project-tags">${project.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}</div>
    ${featuresHTML}
  `;
  
  // Update Footer Links
  const demoLink = document.getElementById('modal-demo');
  const githubLink = document.getElementById('modal-github');
  const downloadLink = document.getElementById('modal-download');
  const requestFeatureLink = document.getElementById('modal-request-feature');
  const reportBugLink = document.getElementById('modal-report-bug');

  // Demo and GitHub links
  demoLink.href = project.demo || '#';
  githubLink.href = project.github || '#';

  const isGithubAvailable = project.github && project.github !== '#';
  githubLink.classList.toggle('disabled', !isGithubAvailable);
  
  const isDemoDisabled = !project.demo || project.demo === '#' || project.status !== 'live';
  demoLink.classList.toggle('disabled', isDemoDisabled);
  document.getElementById('modal-demo-text').textContent = project.status === 'live' ? 'Live Demo' : (project.status === 'ongoing' ? 'Preview (Beta)' : 'Not Available');

  // Download Source button
  downloadLink.classList.toggle('disabled', !isGithubAvailable);
  if (isGithubAvailable) {
    downloadLink.onclick = (event) => openModalById('download-modal', event, project.id);
  } else {
    downloadLink.onclick = (event) => event.preventDefault();
  }

  // Feature Request and Bug Report buttons
  const isFeedbackAvailable = project.request_feature_email && project.request_feature_email !== '#';
  if (isFeedbackAvailable) {
    requestFeatureLink.style.display = 'inline-flex';
    reportBugLink.style.display = 'inline-flex';
    requestFeatureLink.href = `mailto:${project.request_feature_email}?subject=Feature%20Request%20for%20${encodeURIComponent(project.title)}`;
    reportBugLink.href = `mailto:${project.request_feature_email}?subject=Bug%20Report%20for%20${encodeURIComponent(project.title)}`;
  } else {
    requestFeatureLink.style.display = 'none';
    reportBugLink.style.display = 'none';
  }

  openModalById('project-modal');
}

// =================================================================================
// FEATURE-SPECIFIC LOGIC
// =================================================================================

let currentProjectIdForDownload = null;

function handleDownload() {
  const secretKey = document.getElementById('secret-key-input').value;
  if (secretKey === 'secret') {
    const project = projects.find(p => p.id === currentProjectIdForDownload);
    if (project && project.github && project.github !== '#') {
      window.open(`${project.github}/archive/refs/heads/main.zip`, '_blank');
      closeModalById('download-modal');
      showNotification('Download starting...', 'success');
    } else {
      showNotification('Source code not available.', 'error');
    }
  } else {
    showNotification('Incorrect secret key.', 'error');
    document.getElementById('secret-key-input').value = '';
  }
}

function addToCart(event, projectId) {
  event.stopPropagation();
  const project = projects.find(p => p.id === projectId);
  if (!project) return;
  if (cart.find(item => item.id === projectId)) {
    showNotification('Project already in cart!', 'warning');
    return;
  }
  cart.push({ ...project });
  updateCartUI();
  const actionText = { live: 'Added to cart!', ongoing: 'Pre-order added!', concept: 'Reservation added!', construction: 'Added to waitlist!' };
  showNotification(actionText[project.status] || 'Added to cart!', 'success');
}

function removeFromCart(projectId) {
  cart = cart.filter(item => item.id !== projectId);
  updateCartUI();
  showNotification('Removed from cart!', 'info');
}

function updateCartUI() {
  const cartCount = document.getElementById('cart-count');
  const cartItems = document.getElementById('cart-items');
  const cartFooter = document.getElementById('cart-footer');
  const cartTotal = document.getElementById('cart-total');
  
  cartCount.textContent = cart.length;
  
  if (cart.length === 0) {
    cartItems.innerHTML = `<div class="cart-empty"><i class="fas fa-shopping-cart"></i><p>Your cart is empty</p><p>Add some projects to get started!</p></div>`;
    cartFooter.classList.add('hidden');
  } else {
    cartItems.innerHTML = cart.map(item => `
      <div class="cart-item">
        <img class="cart-item-image" src="${item.image}" alt="${item.title}">
        <div class="cart-item-details">
          <div class="cart-item-title">${item.title}</div>
          <div class="cart-item-price">KES ${item.price.toLocaleString()}</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary);">${getStatusText(item.status)}</div>
        </div>
        <button class="cart-item-remove" onclick="removeFromCart(${item.id})" aria-label="Remove ${item.title} from cart"><i class="fas fa-trash"></i></button>
      </div>
    `).join('');
    
    const total = cart.reduce((sum, item) => sum + item.price, 0);
    cartTotal.textContent = `KES ${total.toLocaleString()}`;
    cartFooter.classList.remove('hidden');
  }
}

function toggleCart() {
  const cartSidebar = document.getElementById('cart-sidebar');
  cartSidebar.classList.toggle('open');
  document.body.style.overflow = cartSidebar.classList.contains('open') ? 'hidden' : '';
}

function checkout() {
  if (cart.length === 0) {
    showNotification('Your cart is empty!', 'warning');
    return;
  }
  
  const total = cart.reduce((sum, item) => sum + item.price, 0);
  const items = cart.map(item => `${item.title} (${getStatusText(item.status)}) - KES ${item.price.toLocaleString()}`).join('\n');
  
  const subject = encodeURIComponent('Project Order - Mike Sites Portfolio');
  const body = encodeURIComponent(`Hi Mike,

I would like to order the following projects:

${items}

Total: KES ${total.toLocaleString()}

Please let me know the next steps for payment and project delivery.

Best regards`);
  
  window.open(`mailto:wrootmike@gmail.com?subject=${subject}&body=${body}`);
  
  showNotification('Redirecting to email client...', 'info');
}

// Theme toggle
function toggleTheme() {
  const themes = ['dark', 'light', 'synthwave'];
  const icons = ['fa-moon', 'fa-sun', 'fa-star'];
  const html = document.documentElement;
  const currentTheme = html.getAttribute('data-theme') || 'dark';
  const currentIndex = themes.indexOf(currentTheme);
  const nextIndex = (currentIndex + 1) % themes.length;
  
  const newTheme = themes[nextIndex];
  html.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  
  const themeIcon = document.querySelector('.theme-toggle i');
  themeIcon.className = `fas ${icons[nextIndex]}`;
}

// Load saved theme
function loadTheme() {
  const themes = ['dark', 'light', 'synthwave'];
  const icons = ['fa-moon', 'fa-sun', 'fa-star'];
  const savedTheme = localStorage.getItem('theme') || 'dark';

  document.documentElement.setAttribute('data-theme', savedTheme);
  
  const themeIndex = themes.indexOf(savedTheme);
  const themeIcon = document.querySelector('.theme-toggle i');
  if (themeIndex !== -1) {
    themeIcon.className = `fas ${icons[themeIndex]}`;
  } else {
    // Fallback to dark theme icon
    themeIcon.className = 'fas fa-moon';
  }
}

// General modal closer
function closeModal() {
    const activeModal = document.querySelector('.modal.active');
    if (activeModal) {
        closeModalById(activeModal.id);
    }
}

// Placeholder for unimplemented features
function runCode() {
    console.log("Code playground not implemented yet.");
}

// Notification system
function showNotification(message, type = 'info') {
  const notification = document.createElement('div');
  notification.className = `notification notification-${type}`;
  notification.innerHTML = `
    <i class="fas fa-${getNotificationIcon(type)}"></i>
    <span>${message}</span>
  `;
  
  notification.style.cssText = `
    position: fixed;
    top: 100px;
    right: 20px;
    background: var(--bg-secondary);
    color: var(--text-primary);
    padding: 1rem 1.5rem;
    border-radius: 8px;
    border-left: 4px solid var(--accent-primary);
    box-shadow: 0 10px 30px var(--shadow-color);
    z-index: 10000;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transform: translateX(100%);
    transition: transform 0.3s ease;
  `;
  
  if (type === 'success') notification.style.borderLeftColor = 'var(--success-color)';
  if (type === 'warning') notification.style.borderLeftColor = 'var(--warning-color)';
  if (type === 'error') notification.style.borderLeftColor = 'var(--error-color)';
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.transform = 'translateX(0)';
  }, 100);
  
  setTimeout(() => {
    notification.style.transform = 'translateX(100%)';
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 300);
  }, 3000);
}

function getNotificationIcon(type) {
  const icons = {
    success: 'check-circle',
    warning: 'exclamation-triangle',
    error: 'times-circle',
    info: 'info-circle'
  };
  return icons[type] || 'info-circle';
}

// Keyboard navigation
function handleKeyboard(e) {
  if (e.key === 'Escape') {
    closeModal();
    if (document.getElementById('cart-sidebar').classList.contains('open')) {
      toggleCart();
    }
  }
}

function shareProject(platform, element) {
  const projectUrl = window.location.href;
  const projectTitle = document.getElementById('modal-title').textContent;
  let shareUrl;

  switch (platform) {
    case 'twitter':
      shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(projectUrl)}&text=${encodeURIComponent(projectTitle)}`;
      break;
    case 'linkedin':
      shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(projectUrl)}&title=${encodeURIComponent(projectTitle)}`;
      break;
    case 'facebook':
      shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(projectUrl)}`;
      break;
    default:
      return;
  }
  window.open(shareUrl, '_blank', 'noopener,noreferrer');
}

function handleRequestSubmission(event) {
    event.preventDefault();
    const form = event.target;
    const name = form.name.value;
    const email = form.email.value;
    const projectType = form['project-type'].value;
    const description = form.description.value;
    const budget = form.budget.value || 'Not specified';

    if (!name || !email || !projectType || !description) {
        showNotification('Please fill out all required fields.', 'error');
        return;
    }

    const subject = `Custom Project Request: ${projectType}`;
    const body = `--- New Custom Project Request ---

*Requester Details:*
- Name: ${name}
- Email: ${email}

*Project Information:*
- Type: ${projectType}
- Budget (KES): ${budget}

*Project Description:*
${description}

------------------------------------
`;

    window.location.href = `mailto:wrootmike@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

    showNotification('Thank you! Your request has been prepared for sending.', 'success');
    closeModalById('request-modal');
    form.reset();
}

function handleScrape() {
    const url = document.getElementById('scraper-url').value;
    const query = document.getElementById('scraper-query').value;
    const statusEl = document.getElementById('scraper-status');

    if (!url || !query) {
        statusEl.textContent = 'Please fill in both URL and search query.';
        statusEl.className = 'tool-status error';
        return;
    }

    statusEl.textContent = 'Scraping...';
    statusEl.className = 'tool-status';

    openModalById('scraper-results-modal');
    const resultsStatus = document.getElementById('scraper-results-status');
    const resultsContent = document.getElementById('scraper-results-content');
    resultsStatus.textContent = `Scraping "${url}" for "${query}"...`;
    resultsContent.innerHTML = '';

    setTimeout(() => {
        resultsStatus.textContent = `Results for "${query}":`;
        resultsContent.innerHTML = `
            <div class="scraped-item">
                <h4>Product Title 1</h4>
                <p>This is a description for the first scraped item. It has some details about the product.</p>
                <span>Price: $19.99</span>
            </div>
            <div class="scraped-item">
                <h4>Product Title 2</h4>
                <p>This is another description for the second scraped item. It is also very interesting.</p>
                <span>Price: $29.99</span>
            </div>
            <div class="scraped-item">
                <h4>Product Title 3</h4>
                <p>The third item is the best of all. You should definitely buy it.</p>
                <span>Price: $39.99</span>
            </div>
        `;
        statusEl.textContent = 'Scraping complete!';
        statusEl.className = 'tool-status success';
    }, 2500);
}

function handleTranscription() {
    const url = document.getElementById('transcriber-url').value;
    const statusEl = document.getElementById('transcriber-status');
    const outputEl = document.getElementById('transcriber-output');

    if (!url) {
        statusEl.textContent = 'Please enter a URL to transcribe.';
        statusEl.className = 'tool-status error';
        return;
    }

    statusEl.textContent = 'Transcribing...';
    statusEl.className = 'tool-status';
    outputEl.value = '';

    setTimeout(() => {
        statusEl.textContent = 'Transcription complete!';
        statusEl.className = 'tool-status success';
        outputEl.value = `Hello, and welcome to the presentation. Today, we'll be discussing the future of web development... It's clear that the landscape is constantly evolving, with new frameworks and technologies emerging all the time. One of the most exciting areas of development is the rise of AI-powered tools that can assist with everything from code generation to automated testing. This will undoubtedly have a profound impact on how we build websites and applications in the years to come. Thank you.`;
    }, 2500);
}

function toggleCourse(button) {
    const courseOutline = button.nextElementSibling;
    if (courseOutline.style.display === 'none') {
        courseOutline.style.display = 'block';
        button.textContent = 'Hide Course';
    } else {
        courseOutline.style.display = 'none';
        button.textContent = 'Learn';
    }
}

async function fetchAndRenderChangelog(repoId) {
    const contentDiv = document.getElementById(`changelog-content-${repoId}`);
    const project = projects.find(p => p.id === repoId);

    if (!project || !project.github || project.github === '#') {
        contentDiv.innerHTML = '<p>Repository not found.</p>';
        return;
    }

    contentDiv.dataset.loaded = 'true';
    contentDiv.innerHTML = '<p>Loading changelog...</p>';

    try {
        const url = new URL(project.github);
        const parts = url.pathname.split('/').filter(p => p);
        if (parts.length < 2) throw new Error('Invalid GitHub URL');
        const owner = parts[0];
        const repoName = parts[1].replace('.git', '');;

        const apiUrl = `https://api.github.com/repos/${owner}/${repoName}/commits?per_page=5`;
        const response = await fetch(apiUrl);

        if (!response.ok) {
            throw new Error(`GitHub API error: ${response.statusText}`);
        }

        const commits = await response.json();

        if (commits.length === 0) {
            contentDiv.innerHTML = '<p>No recent commits found.</p>';
            return;
        }

        const changelogHtml = commits.map(commitData => {
            const message = commitData.commit.message.split('\\n')[0];
            const author = commitData.commit.author.name;
            const date = formatDate(commitData.commit.author.date);
            return `
                <div class="commit-entry">
                    <p class="commit-message">${message}</p>
                    <p class="commit-meta">by <strong>${author}</strong> on ${date}</p>
                </div>
            `;
        }).join('');

        contentDiv.innerHTML = changelogHtml;

    } catch (error) {
        console.error('Failed to fetch changelog:', error);
        contentDiv.innerHTML = `<p style="color: var(--error-color);">Failed to load changelog. ${error.message}</p>`;
    }
}

function toggleChangelog(event, repoId) {
    event.stopPropagation(); // Prevent any parent click events

    const contentDiv = document.getElementById(`changelog-content-${repoId}`);
    if (!contentDiv) return;

    const button = event.currentTarget;
    const isVisible = contentDiv.style.display === 'block';

    if (isVisible) {
        contentDiv.style.display = 'none';
        button.innerHTML = '<i class="fas fa-history"></i> View Changelog';
    } else {
        contentDiv.style.display = 'block';
        button.innerHTML = '<i class="fas fa-history"></i> Hide Changelog';
        // If content has not been loaded yet, fetch it
        if (!contentDiv.dataset.loaded) {
            fetchAndRenderChangelog(repoId);
        }
    }
}

function renderGithubRepositories() {
    const repoListContainer = document.getElementById('github-repo-list');
    if (!repoListContainer) return;

    const githubProjects = projects.filter(p => p.github && p.github !== '#');

    if (githubProjects.length === 0) {
        repoListContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">No public repositories found.</p>';
        return;
    }

    const repoListHTML = githubProjects.map(repo => `
        <div class="repo-card">
            <div class="repo-header">
                <h3 class="repo-title">${repo.title}</h3>
                <div class="repo-date">Created on: ${formatDate(repo.date)}</div>
            </div>
            <p class="repo-description">${repo.description}</p>
            <div class="repo-tags">
                ${repo.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
            </div>
            <div class="repo-footer">
                <div class="repo-actions">
                    <a href="${repo.github}" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                        <i class="fab fa-github"></i> View Code
                    </a>
                    <button class="btn btn-primary" onclick="openModalById('download-modal', event, ${repo.id})">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>
                <div class="repo-changelog">
                    <button class="btn btn-secondary" style="width:100%;" onclick="toggleChangelog(event, ${repo.id})">
                        <i class="fas fa-history"></i> View Changelog
                    </button>
                    <div class="changelog-content" id="changelog-content-${repo.id}" style="display: none;"></div>
                </div>
            </div>
        </div>
    `).join('');

    repoListContainer.innerHTML = repoListHTML;
}

async function generateBlogPreview() {
    const previewArea = document.getElementById('preview-area');
    previewArea.innerHTML = '<p style="color: var(--text-secondary);">Generating preview...</p>';

    try {
        // 1. Get user input
        const blogTitle = document.getElementById('blog-title').value || 'My Blog';
        const authorName = document.getElementById('author-name').value || 'Anonymous';
        const authorBio = document.getElementById('author-bio').value || 'This is a short bio about the author.';
        const postTitle = document.getElementById('post-title').value || 'My First Post';
        const postImageUrl = document.getElementById('post-image-url').value || `https://via.placeholder.com/800x400/8a2be2/ffffff?text=Awesome+Image`;
        const postContentMd = document.getElementById('post-content').value || 'This is the default post content. You can use **Markdown**!';
        const postContentHtml = marked.parse(postContentMd);

        // 2. Get selected template
        const selectedTemplate = document.querySelector('.template-card.selected').dataset.template;

        // 3. Fetch template files
        const [htmlTemplate, cssTemplate] = await Promise.all([
            fetch(`blog_template_${selectedTemplate}.html`).then(res => res.text()),
            fetch(`blog_template_${selectedTemplate}.css`).then(res => res.text())
        ]);

        // 4. Replace placeholders
        let finalHtml = htmlTemplate
            .replace(/__BLOG_TITLE__/g, blogTitle)
            .replace(/__AUTHOR_NAME__/g, authorName)
            .replace(/__AUTHOR_BIO__/g, authorBio)
            .replace(/__POST_TITLE__/g, postTitle)
            .replace(/__POST_IMAGE_URL__/g, postImageUrl)
            .replace(/__POST_CONTENT__/g, postContentHtml)
            .replace(/__YEAR__/g, new Date().getFullYear())
            .replace(/__POST_DATE_FRIENDLY__/g, new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }))
            .replace(/__POST_DATE_ISO__/g, new Date().toISOString());

        // 5. Inject CSS
        finalHtml = finalHtml.replace(
            '<link rel="stylesheet" href="style.css">',
            `<style>${cssTemplate}</style>`
        );

        // 6. Display in iframe
        previewArea.innerHTML = '<iframe id="preview-iframe" title="Blog Preview"></iframe>';
        const iframe = document.getElementById('preview-iframe');
        iframe.srcdoc = finalHtml;

        showNotification('Preview generated successfully!', 'success');

    } catch (error) {
        console.error('Error generating blog preview:', error);
        previewArea.innerHTML = `<p style="color: var(--error-color);">Error generating preview. See console for details.</p>`;
        showNotification('Error generating preview.', 'error');
    }
}

async function downloadBlogAsZip() {
    try {
        showNotification('Preparing your download...', 'info');

        // This logic is very similar to the preview function.
        // In a real-world app, this would be refactored to be more DRY.
        const blogTitle = document.getElementById('blog-title').value || 'My Blog';
        const authorName = document.getElementById('author-name').value || 'Anonymous';
        const authorBio = document.getElementById('author-bio').value || 'This is a short bio about the author.';
        const postTitle = document.getElementById('post-title').value || 'My First Post';
        const postImageUrl = document.getElementById('post-image-url').value || `https://via.placeholder.com/800x400/8a2be2/ffffff?text=Awesome+Image`;
        const postContentMd = document.getElementById('post-content').value || 'This is the default post content. You can use **Markdown**!';
        const postContentHtml = marked.parse(postContentMd);

        const selectedTemplate = document.querySelector('.template-card.selected').dataset.template;

        const [htmlTemplate, cssTemplate] = await Promise.all([
            fetch(`blog_template_${selectedTemplate}.html`).then(res => res.text()),
            fetch(`blog_template_${selectedTemplate}.css`).then(res => res.text())
        ]);

        let finalHtml = htmlTemplate
            .replace(/__BLOG_TITLE__/g, blogTitle)
            .replace(/__AUTHOR_NAME__/g, authorName)
            .replace(/__AUTHOR_BIO__/g, authorBio)
            .replace(/__POST_TITLE__/g, postTitle)
            .replace(/__POST_IMAGE_URL__/g, postImageUrl)
            .replace(/__POST_CONTENT__/g, postContentHtml)
            .replace(/__YEAR__/g, new Date().getFullYear())
            .replace(/__POST_DATE_FRIENDLY__/g, new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }))
            .replace(/__POST_DATE_ISO__/g, new Date().toISOString());

        // Create a new zip file
        const zip = new JSZip();
        zip.file("index.html", finalHtml);
        zip.file("style.css", cssTemplate);

        // Generate the zip file and trigger download
        const content = await zip.generateAsync({ type: "blob" });
        saveAs(content, `${blogTitle.toLowerCase().replace(/[^a-z0-9]/g, '-').replace(/-+/g, '-')}.zip`);

        showNotification('Download started!', 'success');

    } catch (error) {
        console.error('Error generating blog for download:', error);
        showNotification('Error preparing download. See console for details.', 'error');
    }
}

// Utility functions
function formatDate(dateString) {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', { 
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}

// Clock widget functionality
function updateClock() {
  const now = new Date();
  
  // Format time with seconds
  const timeOptions = {
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit',
    hour12: true
  };
  
  // Format date
  const dateOptions = {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  };
  
  const timeString = now.toLocaleTimeString('en-US', timeOptions);
  const dateString = now.toLocaleDateString('en-US', dateOptions);
  const seconds = now.getSeconds().toString().padStart(2, '0');
  
  document.getElementById('clock-time').textContent = timeString;
  document.getElementById('clock-date').textContent = dateString;
  document.getElementById('clock-seconds').textContent = `${seconds}s`;
}

// Initialize clock
updateClock();
setInterval(updateClock, 1000);


// Initialize theme on load
loadTheme();


// Touch support for project cards
if ('ontouchstart' in window) {
  document.addEventListener('touchstart', function(e) {
    if (e.target.closest('.project-card')) {
      e.target.closest('.project-card').style.transform = 'scale(0.98)';
    }
  });
  
  document.addEventListener('touchend', function(e) {
    if (e.target.closest('.project-card')) {
      e.target.closest('.project-card').style.transform = '';
    }
  });
}
</script>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>

<script>
// =================================================================================
// DISCUSSION MODAL LOGIC
// =================================================================================

let comments = [
    {
        author: 'Jane Doe',
        date: '2024-07-30T10:00:00Z',
        text: 'This is a really insightful project! I love the modern design and the interactive elements. Keep up the great work!'
    },
    {
        author: 'John Smith',
        date: '2024-07-30T11:30:00Z',
        text: 'I agree with Jane. The UI is very clean. I did notice a small typo on the about page, but other than that, it looks fantastic.'
    }
];

function renderComments() {
    const commentList = document.getElementById('comment-list');
    if (!commentList) return;

    // Sort by date descending before rendering
    comments.sort((a, b) => new Date(b.date) - new Date(a.date));

    if (comments.length === 0) {
        commentList.innerHTML = ''; // The :empty pseudo-class will show the message
        return;
    }

    commentList.innerHTML = comments.map(comment => {
        const initial = comment.author.charAt(0).toUpperCase();
        const timeAgo = formatTimeAgo(new Date(comment.date));

        return `
            <div class="comment-card">
                <div class="comment-avatar">${initial}</div>
                <div class="comment-content">
                    <div class="comment-header">
                        <span class="comment-author">${comment.author}</span>
                        <span class="comment-date">${timeAgo}</span>
                    </div>
                    <p class="comment-text">${comment.text.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</p>
                </div>
            </div>
        `;
    }).join('');
}

function handleCommentSubmit(event) {
    event.preventDefault();
    const nameInput = document.getElementById('commenter-name');
    const commentInput = document.getElementById('comment-text');

    const name = nameInput.value.trim();
    const text = commentInput.value.trim();

    if (!name || !text) {
        showNotification('Please fill out both name and comment fields.', 'warning');
        return;
    }

    comments.push({
        author: name,
        date: new Date().toISOString(),
        text: text
    });

    renderComments();
    event.target.reset(); // Reset the form
    showNotification('Comment posted successfully!', 'success');
}

function formatTimeAgo(date) {
    const seconds = Math.floor((new Date() - date) / 1000);
    if (seconds < 5) return "just now";
    let interval = seconds / 31536000;
    if (interval > 1) return Math.floor(interval) + " years ago";
    interval = seconds / 2592000;
    if (interval > 1) return Math.floor(interval) + " months ago";
    interval = seconds / 86400;
    if (interval > 1) return Math.floor(interval) + " days ago";
    interval = seconds / 3600;
    if (interval > 1) return Math.floor(interval) + " hours ago";
    interval = seconds / 60;
    if (interval > 1) return Math.floor(interval) + " minutes ago";
    return Math.floor(seconds) + " seconds ago";
}


// =================================================================================
// TOOLKIT LOGIC
// =================================================================================

function initializeToolkitEventListeners() {
    // JSON Formatter
    document.getElementById('json-input')?.addEventListener('input', () => {
        document.getElementById('json-status').textContent = '';
    });

    // Character/Word Counter
    document.getElementById('text-counter-input')?.addEventListener('input', updateCounters);

    // Color Converter
    document.getElementById('color-hex')?.addEventListener('input', (e) => convertColor(e.target.value, 'hex'));
    document.getElementById('color-rgb')?.addEventListener('input', (e) => convertColor(e.target.value, 'rgb'));
    document.getElementById('color-hsl')?.addEventListener('input', (e) => convertColor(e.target.value, 'hsl'));

    // URL Transcriber
    document.getElementById('transcribe-btn')?.addEventListener('click', handleTranscription);
}

function formatJSON() {
    const textarea = document.getElementById('json-input');
    const status = document.getElementById('json-status');
    try {
        const jsonObj = JSON.parse(textarea.value);
        textarea.value = JSON.stringify(jsonObj, null, 2);
        status.textContent = 'Valid JSON formatted successfully!';
        status.className = 'tool-status success';
    } catch (e) {
        status.textContent = 'Invalid JSON: ' + e.message;
        status.className = 'tool-status error';
    }
}

function minifyJSON() {
    const textarea = document.getElementById('json-input');
    const status = document.getElementById('json-status');
    try {
        const jsonObj = JSON.parse(textarea.value);
        textarea.value = JSON.stringify(jsonObj);
        status.textContent = 'JSON minified successfully!';
        status.className = 'tool-status success';
    } catch (e) {
        status.textContent = 'Invalid JSON: ' + e.message;
        status.className = 'tool-status error';
    }
}

function copyToClipboard(elementId) {
    const textarea = document.getElementById(elementId);
    textarea.select();
    document.execCommand('copy');
    showNotification('Copied to clipboard!', 'success');
}

function updateCounters() {
    const text = document.getElementById('text-counter-input').value;
    const wordCount = text.trim().split(/\s+/).filter(Boolean).length;
    const charCount = text.length;
    document.getElementById('word-count').textContent = wordCount;
    document.getElementById('char-count').textContent = charCount;
}

function base64Encode() {
    const input = document.getElementById('base64-input').value;
    try {
        document.getElementById('base64-output').value = btoa(input);
    } catch (e) {
        showNotification('Error encoding to Base64.', 'error');
    }
}

function base64Decode() {
    const input = document.getElementById('base64-output').value;
    try {
        document.getElementById('base64-input').value = atob(input);
    } catch (e) {
        showNotification('Invalid Base64 string.', 'error');
    }
}

function convertColor(value, type) {
    let color;
    try {
        if (type === 'hex') {
            if (!/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(value)) return;
            color = value;
        } else if (type === 'rgb') {
            const match = value.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
            if (!match) return;
            color = `rgb(${match[1]}, ${match[2]}, ${match[3]})`;
        } else if (type === 'hsl') {
            const match = value.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);
            if (!match) return;
            color = `hsl(${match[1]}, ${match[2]}%, ${match[3]}%)`;
        }

        const preview = document.getElementById('color-preview');
        preview.style.backgroundColor = color;

        // Use a temporary element to get computed color values
        const tempDiv = document.createElement('div');
        tempDiv.style.color = color;
        document.body.appendChild(tempDiv);
        const computedColor = window.getComputedStyle(tempDiv).color;
        document.body.removeChild(tempDiv);

        const [r, g, b] = computedColor.match(/\d+/g).map(Number);

        if (type !== 'hex') {
            document.getElementById('color-hex').value = `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;
        }
        if (type !== 'rgb') {
            document.getElementById('color-rgb').value = `rgb(${r}, ${g}, ${b})`;
        }
        if (type !== 'hsl') {
            const [h, s, l] = rgbToHsl(r, g, b);
            document.getElementById('color-hsl').value = `hsl(${h}, ${s}%, ${l}%)`;
        }
    } catch (e) {
        // Ignore invalid color inputs for now
    }
}

function rgbToHsl(r, g, b) {
    r /= 255; g /= 255; b /= 255;
    const max = Math.max(r, g, b), min = Math.min(r, g, b);
    let h, s, l = (max + min) / 2;
    if (max === min) {
        h = s = 0; // achromatic
    } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }
    return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];
}

// And call it
document.addEventListener('DOMContentLoaded', initializeToolkitEventListeners);

</script>
</body>
</html>

